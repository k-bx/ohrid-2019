<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>V2.Delay</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">-- The delay monad for potentially non-terminating computation.</a>

<a id="66" class="Keyword">module</a> <a id="73" href="V2.Delay.html" class="Module">V2.Delay</a> <a id="82" class="Keyword">where</a>

<a id="89" class="Keyword">open</a> <a id="94" class="Keyword">import</a> <a id="101" href="Library.html" class="Module">Library</a>

<a id="110" class="Comment">-- Coinductive delay monad.</a>

<a id="139" class="Keyword">mutual</a>

  <a id="149" class="Keyword">record</a> <a id="Delay"></a><a id="156" href="V2.Delay.html#156" class="Record">Delay</a> <a id="162" class="Symbol">(</a><a id="163" href="V2.Delay.html#163" class="Bound">i</a> <a id="165" class="Symbol">:</a> <a id="167" href="Agda.Builtin.Size.html#179" class="Postulate">Size</a><a id="171" class="Symbol">)</a> <a id="173" class="Symbol">(</a><a id="174" href="V2.Delay.html#174" class="Bound">A</a> <a id="176" class="Symbol">:</a> <a id="178" class="PrimitiveType">Set</a><a id="181" class="Symbol">)</a> <a id="183" class="Symbol">:</a> <a id="185" class="PrimitiveType">Set</a> <a id="189" class="Keyword">where</a>
    <a id="199" class="Keyword">coinductive</a>
    <a id="215" class="Keyword">constructor</a> <a id="Delay.delay"></a><a id="227" href="V2.Delay.html#227" class="CoinductiveConstructor">delay</a>
    <a id="237" class="Keyword">field</a>
      <a id="Delay.force"></a><a id="249" href="V2.Delay.html#249" class="Field">force</a> <a id="255" class="Symbol">:</a> <a id="257" class="Symbol">{</a><a id="258" href="V2.Delay.html#258" class="Bound">j</a> <a id="260" class="Symbol">:</a> <a id="262" href="Agda.Builtin.Size.html#211" class="Postulate Operator">Size&lt;</a> <a id="268" href="V2.Delay.html#163" class="Bound">i</a><a id="269" class="Symbol">}</a> <a id="271" class="Symbol">→</a> <a id="273" href="V2.Delay.html#292" class="Datatype">Delay&#39;</a> <a id="280" href="V2.Delay.html#258" class="Bound">j</a> <a id="282" href="V2.Delay.html#174" class="Bound">A</a>

  <a id="287" class="Keyword">data</a> <a id="Delay&#39;"></a><a id="292" href="V2.Delay.html#292" class="Datatype">Delay&#39;</a> <a id="299" class="Symbol">(</a><a id="300" href="V2.Delay.html#300" class="Bound">i</a> <a id="302" class="Symbol">:</a> <a id="304" href="Agda.Builtin.Size.html#179" class="Postulate">Size</a><a id="308" class="Symbol">)</a> <a id="310" class="Symbol">(</a><a id="311" href="V2.Delay.html#311" class="Bound">A</a> <a id="313" class="Symbol">:</a> <a id="315" class="PrimitiveType">Set</a><a id="318" class="Symbol">)</a> <a id="320" class="Symbol">:</a> <a id="322" class="PrimitiveType">Set</a> <a id="326" class="Keyword">where</a>
    <a id="Delay&#39;.return&#39;"></a><a id="336" href="V2.Delay.html#336" class="InductiveConstructor">return&#39;</a> <a id="344" class="Symbol">:</a> <a id="346" href="V2.Delay.html#311" class="Bound">A</a>         <a id="356" class="Symbol">→</a> <a id="358" href="V2.Delay.html#292" class="Datatype">Delay&#39;</a> <a id="365" href="V2.Delay.html#300" class="Bound">i</a> <a id="367" href="V2.Delay.html#311" class="Bound">A</a>
    <a id="Delay&#39;.later&#39;"></a><a id="373" href="V2.Delay.html#373" class="InductiveConstructor">later&#39;</a>  <a id="381" class="Symbol">:</a> <a id="383" href="V2.Delay.html#156" class="Record">Delay</a> <a id="389" href="V2.Delay.html#300" class="Bound">i</a> <a id="391" href="V2.Delay.html#311" class="Bound">A</a> <a id="393" class="Symbol">→</a> <a id="395" href="V2.Delay.html#292" class="Datatype">Delay&#39;</a> <a id="402" href="V2.Delay.html#300" class="Bound">i</a> <a id="404" href="V2.Delay.html#311" class="Bound">A</a>

<a id="407" class="Keyword">open</a> <a id="412" href="V2.Delay.html#156" class="Module">Delay</a> <a id="418" class="Keyword">public</a>

<a id="426" class="Comment">-- Smart constructor.</a>

<a id="later"></a><a id="449" href="V2.Delay.html#449" class="Function">later</a> <a id="455" class="Symbol">:</a> <a id="457" class="Symbol">∀</a> <a id="459" class="Symbol">{</a><a id="460" href="V2.Delay.html#460" class="Bound">A</a> <a id="462" href="V2.Delay.html#462" class="Bound">i</a><a id="463" class="Symbol">}</a> <a id="465" class="Symbol">→</a> <a id="467" href="V2.Delay.html#156" class="Record">Delay</a> <a id="473" href="V2.Delay.html#462" class="Bound">i</a> <a id="475" href="V2.Delay.html#460" class="Bound">A</a> <a id="477" class="Symbol">→</a> <a id="479" href="V2.Delay.html#156" class="Record">Delay</a> <a id="485" class="Symbol">(</a><a id="486" href="Agda.Builtin.Size.html#243" class="Postulate Operator">↑</a> <a id="488" href="V2.Delay.html#462" class="Bound">i</a><a id="489" class="Symbol">)</a> <a id="491" href="V2.Delay.html#460" class="Bound">A</a>
<a id="493" href="V2.Delay.html#449" class="Function">later</a> <a id="499" href="V2.Delay.html#499" class="Bound">x</a> <a id="501" class="Symbol">.</a><a id="502" href="V2.Delay.html#249" class="Field">force</a> <a id="508" class="Symbol">=</a> <a id="510" href="V2.Delay.html#373" class="InductiveConstructor">later&#39;</a> <a id="517" href="V2.Delay.html#499" class="Bound">x</a>

<a id="520" class="Comment">-- Example: non-termination.</a>

<a id="never"></a><a id="550" href="V2.Delay.html#550" class="Function">never</a> <a id="556" class="Symbol">:</a> <a id="558" class="Symbol">∀</a> <a id="560" class="Symbol">{</a><a id="561" href="V2.Delay.html#561" class="Bound">A</a> <a id="563" href="V2.Delay.html#563" class="Bound">i</a><a id="564" class="Symbol">}</a> <a id="566" class="Symbol">→</a> <a id="568" href="V2.Delay.html#156" class="Record">Delay</a> <a id="574" href="V2.Delay.html#561" class="Bound">A</a> <a id="576" href="V2.Delay.html#563" class="Bound">i</a>
<a id="578" href="V2.Delay.html#550" class="Function">never</a> <a id="584" class="Symbol">.</a><a id="585" href="V2.Delay.html#249" class="Field">force</a> <a id="591" class="Symbol">=</a> <a id="593" href="V2.Delay.html#373" class="InductiveConstructor">later&#39;</a> <a id="600" href="V2.Delay.html#550" class="Function">never</a>

<a id="607" class="Comment">-- Monad instance.</a>

<a id="627" class="Keyword">private</a>
  <a id="returnDelay"></a><a id="637" href="V2.Delay.html#637" class="Function">returnDelay</a> <a id="649" class="Symbol">:</a> <a id="651" class="Symbol">∀{</a><a id="653" href="V2.Delay.html#653" class="Bound">A</a> <a id="655" href="V2.Delay.html#655" class="Bound">i</a><a id="656" class="Symbol">}</a> <a id="658" class="Symbol">→</a> <a id="660" href="V2.Delay.html#653" class="Bound">A</a> <a id="662" class="Symbol">→</a> <a id="664" href="V2.Delay.html#156" class="Record">Delay</a> <a id="670" href="V2.Delay.html#655" class="Bound">i</a> <a id="672" href="V2.Delay.html#653" class="Bound">A</a>
  <a id="676" href="V2.Delay.html#637" class="Function">returnDelay</a> <a id="688" href="V2.Delay.html#688" class="Bound">a</a> <a id="690" class="Symbol">.</a><a id="691" href="V2.Delay.html#249" class="Field">force</a> <a id="697" class="Symbol">=</a> <a id="699" href="V2.Delay.html#336" class="InductiveConstructor">return&#39;</a> <a id="707" href="V2.Delay.html#688" class="Bound">a</a>

  <a id="bindDelay"></a><a id="712" href="V2.Delay.html#712" class="Function">bindDelay</a> <a id="722" class="Symbol">:</a> <a id="724" class="Symbol">∀</a> <a id="726" class="Symbol">{</a><a id="727" href="V2.Delay.html#727" class="Bound">i</a> <a id="729" href="V2.Delay.html#729" class="Bound">A</a> <a id="731" href="V2.Delay.html#731" class="Bound">B</a><a id="732" class="Symbol">}</a> <a id="734" class="Symbol">→</a> <a id="736" href="V2.Delay.html#156" class="Record">Delay</a> <a id="742" href="V2.Delay.html#727" class="Bound">i</a> <a id="744" href="V2.Delay.html#729" class="Bound">A</a> <a id="746" class="Symbol">→</a> <a id="748" class="Symbol">(</a><a id="749" href="V2.Delay.html#729" class="Bound">A</a> <a id="751" class="Symbol">→</a> <a id="753" href="V2.Delay.html#156" class="Record">Delay</a> <a id="759" href="V2.Delay.html#727" class="Bound">i</a> <a id="761" href="V2.Delay.html#731" class="Bound">B</a><a id="762" class="Symbol">)</a> <a id="764" class="Symbol">→</a> <a id="766" href="V2.Delay.html#156" class="Record">Delay</a> <a id="772" href="V2.Delay.html#727" class="Bound">i</a> <a id="774" href="V2.Delay.html#731" class="Bound">B</a>
  <a id="778" href="V2.Delay.html#712" class="Function">bindDelay</a> <a id="788" href="V2.Delay.html#788" class="Bound">m</a> <a id="790" href="V2.Delay.html#790" class="Bound">k</a> <a id="792" class="Symbol">.</a><a id="793" href="V2.Delay.html#249" class="Field">force</a> <a id="799" class="Symbol">=</a> <a id="801" href="Function.html#3662" class="Function Operator">case</a> <a id="806" href="V2.Delay.html#788" class="Bound">m</a> <a id="808" class="Symbol">.</a><a id="809" href="V2.Delay.html#249" class="Field">force</a> <a id="815" href="Function.html#3662" class="Function Operator">of</a> <a id="818" class="Symbol">λ</a> <a id="820" class="Keyword">where</a>
    <a id="830" class="Symbol">(</a><a id="831" href="V2.Delay.html#336" class="InductiveConstructor">return&#39;</a> <a id="839" href="V2.Delay.html#839" class="Bound">a</a><a id="840" class="Symbol">)</a> <a id="842" class="Symbol">→</a> <a id="844" href="V2.Delay.html#790" class="Bound">k</a> <a id="846" href="V2.Delay.html#839" class="Bound">a</a> <a id="848" class="Symbol">.</a><a id="849" href="V2.Delay.html#249" class="Field">force</a>
    <a id="859" class="Symbol">(</a><a id="860" href="V2.Delay.html#373" class="InductiveConstructor">later&#39;</a> <a id="867" href="V2.Delay.html#867" class="Bound">m&#39;</a><a id="869" class="Symbol">)</a> <a id="871" class="Symbol">→</a> <a id="873" href="V2.Delay.html#373" class="InductiveConstructor">later&#39;</a> <a id="880" class="Symbol">(</a><a id="881" href="V2.Delay.html#712" class="Function">bindDelay</a> <a id="891" href="V2.Delay.html#867" class="Bound">m&#39;</a> <a id="894" href="V2.Delay.html#790" class="Bound">k</a><a id="895" class="Symbol">)</a>

<a id="898" class="Keyword">instance</a>
  <a id="functorDelay"></a><a id="909" href="V2.Delay.html#909" class="Function">functorDelay</a> <a id="922" class="Symbol">:</a> <a id="924" class="Symbol">∀</a> <a id="926" class="Symbol">{</a><a id="927" href="V2.Delay.html#927" class="Bound">i</a><a id="928" class="Symbol">}</a> <a id="930" class="Symbol">→</a> <a id="932" href="Library.Monad.html#157" class="Record">Functor</a> <a id="940" class="Symbol">(</a><a id="941" href="V2.Delay.html#156" class="Record">Delay</a> <a id="947" href="V2.Delay.html#927" class="Bound">i</a><a id="948" class="Symbol">)</a>
  <a id="952" href="Library.Monad.html#245" class="Field">fmap</a> <a id="957" class="Symbol">{{</a><a id="959" href="V2.Delay.html#909" class="Function">functorDelay</a><a id="971" class="Symbol">}}</a> <a id="974" href="V2.Delay.html#974" class="Bound">f</a> <a id="976" href="V2.Delay.html#976" class="Bound">mx</a> <a id="979" class="Symbol">=</a> <a id="981" href="V2.Delay.html#712" class="Function">bindDelay</a> <a id="991" href="V2.Delay.html#976" class="Bound">mx</a> <a id="994" class="Symbol">(λ</a> <a id="997" href="V2.Delay.html#997" class="Bound">x</a> <a id="999" class="Symbol">→</a> <a id="1001" href="V2.Delay.html#637" class="Function">returnDelay</a> <a id="1013" class="Symbol">(</a><a id="1014" href="V2.Delay.html#974" class="Bound">f</a> <a id="1016" href="V2.Delay.html#997" class="Bound">x</a><a id="1017" class="Symbol">))</a>

  <a id="applicativeDelay"></a><a id="1023" href="V2.Delay.html#1023" class="Function">applicativeDelay</a> <a id="1040" class="Symbol">:</a> <a id="1042" class="Symbol">∀</a> <a id="1044" class="Symbol">{</a><a id="1045" href="V2.Delay.html#1045" class="Bound">i</a><a id="1046" class="Symbol">}</a> <a id="1048" class="Symbol">→</a> <a id="1050" href="Library.Monad.html#729" class="Function">Applicative</a> <a id="1062" class="Symbol">(</a><a id="1063" href="V2.Delay.html#156" class="Record">Delay</a> <a id="1069" href="V2.Delay.html#1045" class="Bound">i</a><a id="1070" class="Symbol">)</a>
  <a id="1074" href="Library.Monad.html#487" class="Field">pure</a>  <a id="1080" class="Symbol">{{</a><a id="1082" href="V2.Delay.html#1023" class="Function">applicativeDelay</a><a id="1098" class="Symbol">}}</a>       <a id="1107" class="Symbol">=</a> <a id="1109" href="V2.Delay.html#637" class="Function">returnDelay</a>
  <a id="1123" href="Library.Monad.html#521" class="Field Operator">_&lt;*&gt;_</a> <a id="1129" class="Symbol">{{</a><a id="1131" href="V2.Delay.html#1023" class="Function">applicativeDelay</a><a id="1147" class="Symbol">}}</a> <a id="1150" href="V2.Delay.html#1150" class="Bound">mf</a> <a id="1153" href="V2.Delay.html#1153" class="Bound">mx</a> <a id="1156" class="Symbol">=</a> <a id="1158" href="V2.Delay.html#712" class="Function">bindDelay</a> <a id="1168" href="V2.Delay.html#1150" class="Bound">mf</a> <a id="1171" class="Symbol">(</a><a id="1172" href="Library.Monad.html#284" class="Function Operator">_&lt;$&gt;</a> <a id="1177" href="V2.Delay.html#1153" class="Bound">mx</a><a id="1179" class="Symbol">)</a>

  <a id="monadDelay"></a><a id="1184" href="V2.Delay.html#1184" class="Function">monadDelay</a> <a id="1195" class="Symbol">:</a> <a id="1197" class="Symbol">∀</a> <a id="1199" class="Symbol">{</a><a id="1200" href="V2.Delay.html#1200" class="Bound">i</a><a id="1201" class="Symbol">}</a> <a id="1203" class="Symbol">→</a> <a id="1205" href="Library.Monad.html#1395" class="Function">Monad</a> <a id="1211" class="Symbol">(</a><a id="1212" href="V2.Delay.html#156" class="Record">Delay</a> <a id="1218" href="V2.Delay.html#1200" class="Bound">i</a><a id="1219" class="Symbol">)</a>
  <a id="1223" href="Library.Monad.html#1002" class="Field Operator">_&gt;&gt;=_</a> <a id="1229" class="Symbol">{{</a><a id="1231" href="V2.Delay.html#1184" class="Function">monadDelay</a><a id="1241" class="Symbol">}}</a> <a id="1244" class="Symbol">=</a> <a id="1246" href="V2.Delay.html#712" class="Function">bindDelay</a>

<a id="1257" class="Comment">-- Unwinding the delay monad might not terminate.</a>

<a id="1308" class="Symbol">{-#</a> <a id="1312" class="Keyword">NON_TERMINATING</a> <a id="1328" class="Symbol">#-}</a>
<a id="runDelay"></a><a id="1332" href="V2.Delay.html#1332" class="Function">runDelay</a> <a id="1341" class="Symbol">:</a> <a id="1343" class="Symbol">∀{</a><a id="1345" href="V2.Delay.html#1345" class="Bound">A</a><a id="1346" class="Symbol">}</a> <a id="1348" class="Symbol">→</a> <a id="1350" href="V2.Delay.html#156" class="Record">Delay</a> <a id="1356" href="Agda.Builtin.Size.html#275" class="Postulate">∞</a> <a id="1358" href="V2.Delay.html#1345" class="Bound">A</a> <a id="1360" class="Symbol">→</a> <a id="1362" href="V2.Delay.html#1345" class="Bound">A</a>
<a id="1364" href="V2.Delay.html#1332" class="Function">runDelay</a> <a id="1373" href="V2.Delay.html#1373" class="Bound">m</a> <a id="1375" class="Symbol">=</a> <a id="1377" href="Function.html#3662" class="Function Operator">case</a> <a id="1382" href="V2.Delay.html#1373" class="Bound">m</a> <a id="1384" class="Symbol">.</a><a id="1385" href="V2.Delay.html#249" class="Field">force</a> <a id="1391" href="Function.html#3662" class="Function Operator">of</a> <a id="1394" class="Symbol">λ</a> <a id="1396" class="Keyword">where</a>
  <a id="1404" class="Symbol">(</a><a id="1405" href="V2.Delay.html#336" class="InductiveConstructor">return&#39;</a> <a id="1413" href="V2.Delay.html#1413" class="Bound">a</a><a id="1414" class="Symbol">)</a> <a id="1416" class="Symbol">→</a> <a id="1418" href="V2.Delay.html#1413" class="Bound">a</a>
  <a id="1422" class="Symbol">(</a><a id="1423" href="V2.Delay.html#373" class="InductiveConstructor">later&#39;</a> <a id="1430" href="V2.Delay.html#1430" class="Bound">m&#39;</a><a id="1432" class="Symbol">)</a> <a id="1434" class="Symbol">→</a> <a id="1436" href="V2.Delay.html#1332" class="Function">runDelay</a> <a id="1445" href="V2.Delay.html#1430" class="Bound">m&#39;</a>

<a id="1449" class="Comment">-- -}</a>
<a id="1455" class="Comment">-- -}</a>
<a id="1461" class="Comment">-- -}</a>
<a id="1467" class="Comment">-- -}</a>
<a id="1473" class="Comment">-- -}</a>
</pre></body></html>
