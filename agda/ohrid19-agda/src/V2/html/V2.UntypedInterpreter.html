<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>V2.UntypedInterpreter</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">-- Untyped interpreter for the WHILE language.</a>
<a id="48" class="Comment">--</a>
<a id="51" class="Comment">-- * Runs directly on the unchecked abstract syntax tree.</a>
<a id="109" class="Comment">-- * May fail due to scope and other runtime errors.</a>
<a id="162" class="Comment">-- * while loops may not terminate.</a>

<a id="199" class="Keyword">module</a> <a id="206" href="V2.UntypedInterpreter.html" class="Module">V2.UntypedInterpreter</a> <a id="228" class="Keyword">where</a>

<a id="235" class="Keyword">open</a> <a id="240" class="Keyword">import</a> <a id="247" href="Library.html" class="Module">Library</a>
<a id="255" class="Keyword">open</a> <a id="260" class="Keyword">import</a> <a id="267" href="V2.AST.html" class="Module">V2.AST</a>

<a id="275" class="Comment">-- Untyped values.</a>

<a id="295" class="Keyword">data</a> <a id="Val"></a><a id="300" href="V2.UntypedInterpreter.html#300" class="Datatype">Val</a> <a id="304" class="Symbol">:</a> <a id="306" class="PrimitiveType">Set</a> <a id="310" class="Keyword">where</a>
  <a id="Val.intV"></a><a id="318" href="V2.UntypedInterpreter.html#318" class="InductiveConstructor">intV</a>  <a id="324" class="Symbol">:</a> <a id="326" href="Agda.Builtin.Int.html#219" class="Datatype">ℤ</a>       <a id="334" class="Symbol">→</a> <a id="336" href="V2.UntypedInterpreter.html#300" class="Datatype">Val</a>
  <a id="Val.boolV"></a><a id="342" href="V2.UntypedInterpreter.html#342" class="InductiveConstructor">boolV</a> <a id="348" class="Symbol">:</a> <a id="350" href="V2.AST.html#474" class="Datatype">Boolean</a> <a id="358" class="Symbol">→</a> <a id="360" href="V2.UntypedInterpreter.html#300" class="Datatype">Val</a>

<a id="365" class="Keyword">instance</a>
  <a id="PrintVal"></a><a id="376" href="V2.UntypedInterpreter.html#376" class="Function">PrintVal</a> <a id="385" class="Symbol">:</a> <a id="387" href="Library.Print.html#196" class="Record">Print</a> <a id="393" href="V2.UntypedInterpreter.html#300" class="Datatype">Val</a>
  <a id="399" href="Library.Print.html#244" class="Field">print</a> <a id="405" class="Symbol">{{</a><a id="407" href="V2.UntypedInterpreter.html#376" class="Function">PrintVal</a><a id="415" class="Symbol">}}</a> <a id="418" class="Symbol">=</a> <a id="420" class="Symbol">λ</a> <a id="422" class="Keyword">where</a>
    <a id="432" class="Symbol">(</a><a id="433" href="V2.UntypedInterpreter.html#318" class="InductiveConstructor">intV</a> <a id="438" href="V2.UntypedInterpreter.html#438" class="Bound">i</a><a id="439" class="Symbol">)</a>  <a id="442" class="Symbol">→</a> <a id="444" href="Library.Print.html#244" class="Field">print</a> <a id="450" href="V2.UntypedInterpreter.html#438" class="Bound">i</a>
    <a id="456" class="Symbol">(</a><a id="457" href="V2.UntypedInterpreter.html#342" class="InductiveConstructor">boolV</a> <a id="463" href="V2.UntypedInterpreter.html#463" class="Bound">b</a><a id="464" class="Symbol">)</a> <a id="466" class="Symbol">→</a> <a id="468" href="Library.Print.html#244" class="Field">print</a> <a id="474" href="V2.UntypedInterpreter.html#463" class="Bound">b</a>

<a id="477" class="Comment">-- Poor man&#39;s environments (association list).</a>

<a id="Env"></a><a id="525" href="V2.UntypedInterpreter.html#525" class="Function">Env</a> <a id="529" class="Symbol">:</a> <a id="531" class="PrimitiveType">Set</a>
<a id="535" href="V2.UntypedInterpreter.html#525" class="Function">Env</a> <a id="539" class="Symbol">=</a> <a id="541" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="546" class="Symbol">(</a><a id="547" href="V2.AST.html#282" class="Datatype">Id</a> <a id="550" href="Data.Product.html#1162" class="Function Operator">×</a> <a id="552" href="V2.UntypedInterpreter.html#300" class="Datatype">Val</a><a id="555" class="Symbol">)</a>

<a id="558" class="Comment">-- Looking up the value bound to a variable in an environment.</a>

<a id="lookupId"></a><a id="622" href="V2.UntypedInterpreter.html#622" class="Function">lookupId</a> <a id="631" class="Symbol">:</a> <a id="633" href="V2.UntypedInterpreter.html#525" class="Function">Env</a> <a id="637" class="Symbol">→</a> <a id="639" href="V2.AST.html#282" class="Datatype">Id</a> <a id="642" class="Symbol">→</a> <a id="644" href="Data.Maybe.Base.html#795" class="Datatype">Maybe</a> <a id="650" href="V2.UntypedInterpreter.html#300" class="Datatype">Val</a>
<a id="654" href="V2.UntypedInterpreter.html#622" class="Function">lookupId</a> <a id="663" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>             <a id="678" href="V2.UntypedInterpreter.html#678" class="Bound">y</a> <a id="680" class="Symbol">=</a> <a id="682" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>
<a id="690" href="V2.UntypedInterpreter.html#622" class="Function">lookupId</a> <a id="699" class="Symbol">((</a><a id="701" href="V2.UntypedInterpreter.html#701" class="Bound">x</a> <a id="703" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="705" href="V2.UntypedInterpreter.html#705" class="Bound">v</a><a id="706" class="Symbol">)</a> <a id="708" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="710" href="V2.UntypedInterpreter.html#710" class="Bound">xs</a><a id="712" class="Symbol">)</a> <a id="714" href="V2.UntypedInterpreter.html#714" class="Bound">y</a> <a id="716" class="Symbol">=</a>
  <a id="720" href="Data.Bool.Base.html#1312" class="Function Operator">if</a> <a id="723" href="V2.UntypedInterpreter.html#701" class="Bound">x</a> <a id="725" href="Library.Eq.html#688" class="Function Operator">==</a> <a id="728" href="V2.UntypedInterpreter.html#714" class="Bound">y</a>
  <a id="732" href="Data.Bool.Base.html#1312" class="Function Operator">then</a> <a id="737" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="742" href="V2.UntypedInterpreter.html#705" class="Bound">v</a>
  <a id="746" href="Data.Bool.Base.html#1312" class="Function Operator">else</a> <a id="751" href="V2.UntypedInterpreter.html#622" class="Function">lookupId</a> <a id="760" href="V2.UntypedInterpreter.html#710" class="Bound">xs</a> <a id="763" href="V2.UntypedInterpreter.html#714" class="Bound">y</a>

<a id="766" class="Comment">-- Adding or updating a binding in the environment.</a>

<a id="updateEnv"></a><a id="819" href="V2.UntypedInterpreter.html#819" class="Function">updateEnv</a> <a id="829" class="Symbol">:</a> <a id="831" href="V2.AST.html#282" class="Datatype">Id</a> <a id="834" class="Symbol">→</a> <a id="836" href="V2.UntypedInterpreter.html#300" class="Datatype">Val</a> <a id="840" class="Symbol">→</a> <a id="842" href="V2.UntypedInterpreter.html#525" class="Function">Env</a> <a id="846" class="Symbol">→</a> <a id="848" href="V2.UntypedInterpreter.html#525" class="Function">Env</a>
<a id="852" href="V2.UntypedInterpreter.html#819" class="Function">updateEnv</a> <a id="862" href="V2.UntypedInterpreter.html#862" class="Bound">x</a> <a id="864" href="V2.UntypedInterpreter.html#864" class="Bound">v</a> <a id="866" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>            <a id="880" class="Symbol">=</a> <a id="882" class="Symbol">(</a><a id="883" href="V2.UntypedInterpreter.html#862" class="Bound">x</a> <a id="885" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="887" href="V2.UntypedInterpreter.html#864" class="Bound">v</a><a id="888" class="Symbol">)</a> <a id="890" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="892" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>
<a id="895" href="V2.UntypedInterpreter.html#819" class="Function">updateEnv</a> <a id="905" href="V2.UntypedInterpreter.html#905" class="Bound">x</a> <a id="907" href="V2.UntypedInterpreter.html#907" class="Bound">v</a> <a id="909" class="Symbol">((</a><a id="911" href="V2.UntypedInterpreter.html#911" class="Bound">y</a> <a id="913" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="915" href="V2.UntypedInterpreter.html#915" class="Bound">w</a><a id="916" class="Symbol">)</a> <a id="918" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="920" href="V2.UntypedInterpreter.html#920" class="Bound">ρ</a><a id="921" class="Symbol">)</a> <a id="923" class="Symbol">=</a>
  <a id="927" href="Data.Bool.Base.html#1312" class="Function Operator">if</a> <a id="930" href="V2.UntypedInterpreter.html#905" class="Bound">x</a> <a id="932" href="Library.Eq.html#688" class="Function Operator">==</a> <a id="935" href="V2.UntypedInterpreter.html#911" class="Bound">y</a>
  <a id="939" href="Data.Bool.Base.html#1312" class="Function Operator">then</a> <a id="944" class="Symbol">(</a><a id="945" href="V2.UntypedInterpreter.html#905" class="Bound">x</a> <a id="947" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="949" href="V2.UntypedInterpreter.html#907" class="Bound">v</a><a id="950" class="Symbol">)</a> <a id="952" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="954" href="V2.UntypedInterpreter.html#920" class="Bound">ρ</a>
  <a id="958" href="Data.Bool.Base.html#1312" class="Function Operator">else</a> <a id="963" class="Symbol">(</a><a id="964" href="V2.UntypedInterpreter.html#911" class="Bound">y</a> <a id="966" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="968" href="V2.UntypedInterpreter.html#915" class="Bound">w</a><a id="969" class="Symbol">)</a> <a id="971" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="973" href="V2.UntypedInterpreter.html#819" class="Function">updateEnv</a> <a id="983" href="V2.UntypedInterpreter.html#905" class="Bound">x</a> <a id="985" href="V2.UntypedInterpreter.html#907" class="Bound">v</a> <a id="987" href="V2.UntypedInterpreter.html#920" class="Bound">ρ</a>

<a id="990" class="Comment">-- -- Poor man&#39;s version, keeps history of bindings.</a>
<a id="1043" class="Comment">-- updateEnv x v ρ = (x , v) ∷ ρ</a>
<a id="1076" class="Comment">-- updateEnv : Id → Val → Env → Env</a>

<a id="1113" class="Comment">-- Semantics of operations.</a>

<a id="1142" class="Comment">-- Boolean negation.</a>

<a id="bNot"></a><a id="1164" href="V2.UntypedInterpreter.html#1164" class="Function">bNot</a> <a id="1169" class="Symbol">:</a> <a id="1171" href="V2.AST.html#474" class="Datatype">Boolean</a> <a id="1179" class="Symbol">→</a> <a id="1181" href="V2.AST.html#474" class="Datatype">Boolean</a>
<a id="1189" href="V2.UntypedInterpreter.html#1164" class="Function">bNot</a> <a id="1194" href="V2.AST.html#496" class="InductiveConstructor">true</a> <a id="1199" class="Symbol">=</a> <a id="1201" href="V2.AST.html#501" class="InductiveConstructor">false</a>
<a id="1207" href="V2.UntypedInterpreter.html#1164" class="Function">bNot</a> <a id="1212" href="V2.AST.html#501" class="InductiveConstructor">false</a> <a id="1218" class="Symbol">=</a> <a id="1220" href="V2.AST.html#496" class="InductiveConstructor">true</a>

<a id="1226" class="Comment">-- Boolean conjunction.</a>

<a id="bAnd"></a><a id="1251" href="V2.UntypedInterpreter.html#1251" class="Function">bAnd</a> <a id="1256" class="Symbol">:</a> <a id="1258" href="V2.AST.html#474" class="Datatype">Boolean</a> <a id="1266" class="Symbol">→</a> <a id="1268" href="V2.AST.html#474" class="Datatype">Boolean</a> <a id="1276" class="Symbol">→</a> <a id="1278" href="V2.AST.html#474" class="Datatype">Boolean</a>
<a id="1286" href="V2.UntypedInterpreter.html#1251" class="Function">bAnd</a> <a id="1291" href="V2.AST.html#496" class="InductiveConstructor">true</a>  <a id="1297" href="V2.UntypedInterpreter.html#1297" class="Bound">b</a> <a id="1299" class="Symbol">=</a> <a id="1301" href="V2.UntypedInterpreter.html#1297" class="Bound">b</a>
<a id="1303" href="V2.UntypedInterpreter.html#1251" class="Function">bAnd</a> <a id="1308" href="V2.AST.html#501" class="InductiveConstructor">false</a> <a id="1314" class="Symbol">_</a> <a id="1316" class="Symbol">=</a> <a id="1318" href="V2.AST.html#501" class="InductiveConstructor">false</a>

<a id="1325" class="Comment">-- Boolean conditional</a>

<a id="bIf"></a><a id="1349" href="V2.UntypedInterpreter.html#1349" class="Function">bIf</a> <a id="1353" class="Symbol">:</a> <a id="1355" class="Symbol">{</a><a id="1356" href="V2.UntypedInterpreter.html#1356" class="Bound">A</a> <a id="1358" class="Symbol">:</a> <a id="1360" class="PrimitiveType">Set</a><a id="1363" class="Symbol">}</a> <a id="1365" class="Symbol">→</a> <a id="1367" href="V2.AST.html#474" class="Datatype">Boolean</a> <a id="1375" class="Symbol">→</a> <a id="1377" href="V2.UntypedInterpreter.html#1356" class="Bound">A</a> <a id="1379" class="Symbol">→</a> <a id="1381" href="V2.UntypedInterpreter.html#1356" class="Bound">A</a> <a id="1383" class="Symbol">→</a> <a id="1385" href="V2.UntypedInterpreter.html#1356" class="Bound">A</a>
<a id="1387" href="V2.UntypedInterpreter.html#1349" class="Function">bIf</a> <a id="1391" href="V2.AST.html#496" class="InductiveConstructor">true</a>  <a id="1397" href="V2.UntypedInterpreter.html#1397" class="Bound">x</a> <a id="1399" href="V2.UntypedInterpreter.html#1399" class="Bound">y</a> <a id="1401" class="Symbol">=</a> <a id="1403" href="V2.UntypedInterpreter.html#1397" class="Bound">x</a>
<a id="1405" href="V2.UntypedInterpreter.html#1349" class="Function">bIf</a> <a id="1409" href="V2.AST.html#501" class="InductiveConstructor">false</a> <a id="1415" href="V2.UntypedInterpreter.html#1415" class="Bound">x</a> <a id="1417" href="V2.UntypedInterpreter.html#1417" class="Bound">y</a> <a id="1419" class="Symbol">=</a> <a id="1421" href="V2.UntypedInterpreter.html#1417" class="Bound">y</a>

<a id="1424" class="Comment">-- Greater-than on integers.</a>

<a id="iGt"></a><a id="1454" href="V2.UntypedInterpreter.html#1454" class="Function">iGt</a> <a id="1458" class="Symbol">:</a> <a id="1460" class="Symbol">(</a><a id="1461" href="V2.UntypedInterpreter.html#1461" class="Bound">i</a> <a id="1463" href="V2.UntypedInterpreter.html#1463" class="Bound">j</a> <a id="1465" class="Symbol">:</a> <a id="1467" href="Agda.Builtin.Int.html#219" class="Datatype">ℤ</a><a id="1468" class="Symbol">)</a> <a id="1470" class="Symbol">→</a> <a id="1472" href="V2.AST.html#474" class="Datatype">Boolean</a>
<a id="1480" href="V2.UntypedInterpreter.html#1454" class="Function">iGt</a> <a id="1484" href="V2.UntypedInterpreter.html#1484" class="Bound">i</a> <a id="1486" href="V2.UntypedInterpreter.html#1486" class="Bound">j</a> <a id="1488" class="Symbol">=</a> <a id="1490" href="Function.html#3662" class="Function Operator">case</a> <a id="1495" href="V2.UntypedInterpreter.html#1484" class="Bound">i</a> <a id="1497" href="Library.html#2213" class="Function Operator">Integer.&lt;=</a> <a id="1508" href="V2.UntypedInterpreter.html#1486" class="Bound">j</a> <a id="1510" href="Function.html#3662" class="Function Operator">of</a> <a id="1513" class="Symbol">λ</a> <a id="1515" class="Keyword">where</a>
  <a id="1523" href="Agda.Builtin.Bool.html#154" class="InductiveConstructor">false</a> <a id="1529" class="Symbol">→</a> <a id="1531" href="V2.AST.html#496" class="InductiveConstructor">true</a>
  <a id="1538" href="Agda.Builtin.Bool.html#160" class="InductiveConstructor">true</a>  <a id="1544" class="Symbol">→</a> <a id="1546" href="V2.AST.html#501" class="InductiveConstructor">false</a>

<a id="1553" class="Comment">-- Evaluation of expressions.  The environment is fixed.</a>

<a id="1611" class="Keyword">module</a> <a id="EvalExp"></a><a id="1618" href="V2.UntypedInterpreter.html#1618" class="Module">EvalExp</a> <a id="1626" class="Symbol">(</a><a id="1627" href="V2.UntypedInterpreter.html#1627" class="Bound">ρ</a> <a id="1629" class="Symbol">:</a> <a id="1631" href="V2.UntypedInterpreter.html#525" class="Function">Env</a><a id="1634" class="Symbol">)</a> <a id="1636" class="Keyword">where</a>

  <a id="1645" class="Comment">-- Evaluation may fail due to scope or type errors, thus eval is partial.</a>
  <a id="1721" class="Comment">-- E.g. eval (eNot (eInt zero)) ≡ nothing.</a>

  <a id="EvalExp.eval"></a><a id="1767" href="V2.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="1772" class="Symbol">:</a> <a id="1774" href="V2.AST.html#584" class="Datatype">Exp</a> <a id="1778" class="Symbol">→</a> <a id="1780" href="Data.Maybe.Base.html#795" class="Datatype">Maybe</a> <a id="1786" href="V2.UntypedInterpreter.html#300" class="Datatype">Val</a>
  <a id="1792" href="V2.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="1797" class="Symbol">(</a><a id="1798" href="V2.AST.html#602" class="InductiveConstructor">eId</a> <a id="1802" href="V2.UntypedInterpreter.html#1802" class="Bound">x</a><a id="1803" class="Symbol">)</a>   <a id="1807" class="Symbol">=</a> <a id="1809" href="V2.UntypedInterpreter.html#622" class="Function">lookupId</a> <a id="1818" href="V2.UntypedInterpreter.html#1627" class="Bound">ρ</a> <a id="1820" href="V2.UntypedInterpreter.html#1802" class="Bound">x</a>
  <a id="1824" href="V2.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="1829" class="Symbol">(</a><a id="1830" href="V2.AST.html#636" class="InductiveConstructor">eInt</a> <a id="1835" href="V2.UntypedInterpreter.html#1835" class="Bound">i</a><a id="1836" class="Symbol">)</a>  <a id="1839" class="Symbol">=</a> <a id="1841" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="1846" class="Symbol">(</a><a id="1847" href="V2.UntypedInterpreter.html#318" class="InductiveConstructor">intV</a> <a id="1852" href="V2.UntypedInterpreter.html#1835" class="Bound">i</a><a id="1853" class="Symbol">)</a>
  <a id="1857" href="V2.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="1862" class="Symbol">(</a><a id="1863" href="V2.AST.html#670" class="InductiveConstructor">eBool</a> <a id="1869" href="V2.UntypedInterpreter.html#1869" class="Bound">b</a><a id="1870" class="Symbol">)</a> <a id="1872" class="Symbol">=</a> <a id="1874" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="1879" class="Symbol">(</a><a id="1880" href="V2.UntypedInterpreter.html#342" class="InductiveConstructor">boolV</a> <a id="1886" href="V2.UntypedInterpreter.html#1869" class="Bound">b</a><a id="1887" class="Symbol">)</a>
  <a id="1891" href="V2.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="1896" class="Symbol">(</a><a id="1897" href="V2.AST.html#704" class="InductiveConstructor">ePlus</a> <a id="1903" href="V2.UntypedInterpreter.html#1903" class="Bound">e₁</a> <a id="1906" href="V2.UntypedInterpreter.html#1906" class="Bound">e₂</a><a id="1908" class="Symbol">)</a> <a id="1910" class="Symbol">=</a> <a id="1912" href="Function.html#3662" class="Function Operator">case</a> <a id="1917" class="Symbol">(</a><a id="1918" href="V2.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="1923" href="V2.UntypedInterpreter.html#1903" class="Bound">e₁</a> <a id="1926" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1928" href="V2.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="1933" href="V2.UntypedInterpreter.html#1906" class="Bound">e₂</a><a id="1935" class="Symbol">)</a> <a id="1937" href="Function.html#3662" class="Function Operator">of</a> <a id="1940" class="Symbol">λ</a> <a id="1942" class="Keyword">where</a>
    <a id="1952" class="Symbol">(</a><a id="1953" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="1958" class="Symbol">(</a><a id="1959" href="V2.UntypedInterpreter.html#318" class="InductiveConstructor">intV</a> <a id="1964" href="V2.UntypedInterpreter.html#1964" class="Bound">i</a><a id="1965" class="Symbol">)</a> <a id="1967" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1969" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="1974" class="Symbol">(</a><a id="1975" href="V2.UntypedInterpreter.html#318" class="InductiveConstructor">intV</a> <a id="1980" href="V2.UntypedInterpreter.html#1980" class="Bound">j</a><a id="1981" class="Symbol">))</a> <a id="1984" class="Symbol">→</a> <a id="1986" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="1991" class="Symbol">(</a><a id="1992" href="V2.UntypedInterpreter.html#318" class="InductiveConstructor">intV</a> <a id="1997" class="Symbol">(</a><a id="1998" href="V2.UntypedInterpreter.html#1964" class="Bound">i</a> <a id="2000" href="Data.Integer.Base.html#2950" class="Function Operator">+</a> <a id="2002" href="V2.UntypedInterpreter.html#1980" class="Bound">j</a><a id="2003" class="Symbol">))</a>
    <a id="2010" class="CatchallClause Symbol">_</a> <a id="2012" class="Symbol">→</a> <a id="2014" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>
  <a id="2024" href="V2.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="2029" class="Symbol">(</a><a id="2030" href="V2.AST.html#738" class="InductiveConstructor">eGt</a> <a id="2034" href="V2.UntypedInterpreter.html#2034" class="Bound">e₁</a> <a id="2037" href="V2.UntypedInterpreter.html#2037" class="Bound">e₂</a><a id="2039" class="Symbol">)</a> <a id="2041" class="Symbol">=</a> <a id="2043" href="Function.html#3662" class="Function Operator">case</a> <a id="2048" class="Symbol">(</a><a id="2049" href="V2.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="2054" href="V2.UntypedInterpreter.html#2034" class="Bound">e₁</a> <a id="2057" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2059" href="V2.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="2064" href="V2.UntypedInterpreter.html#2037" class="Bound">e₂</a><a id="2066" class="Symbol">)</a> <a id="2068" href="Function.html#3662" class="Function Operator">of</a> <a id="2071" class="Symbol">λ</a> <a id="2073" class="Keyword">where</a>
    <a id="2083" class="Symbol">(</a><a id="2084" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2089" class="Symbol">(</a><a id="2090" href="V2.UntypedInterpreter.html#318" class="InductiveConstructor">intV</a> <a id="2095" href="V2.UntypedInterpreter.html#2095" class="Bound">i</a><a id="2096" class="Symbol">)</a> <a id="2098" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2100" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2105" class="Symbol">(</a><a id="2106" href="V2.UntypedInterpreter.html#318" class="InductiveConstructor">intV</a> <a id="2111" href="V2.UntypedInterpreter.html#2111" class="Bound">j</a><a id="2112" class="Symbol">))</a> <a id="2115" class="Symbol">→</a> <a id="2117" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2122" class="Symbol">(</a><a id="2123" href="V2.UntypedInterpreter.html#342" class="InductiveConstructor">boolV</a> <a id="2129" class="Symbol">(</a><a id="2130" href="V2.UntypedInterpreter.html#1454" class="Function">iGt</a> <a id="2134" href="V2.UntypedInterpreter.html#2095" class="Bound">i</a> <a id="2136" href="V2.UntypedInterpreter.html#2111" class="Bound">j</a><a id="2137" class="Symbol">))</a>
    <a id="2144" class="CatchallClause Symbol">_</a> <a id="2146" class="Symbol">→</a> <a id="2148" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>
  <a id="2158" href="V2.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="2163" class="Symbol">(</a><a id="2164" href="V2.AST.html#772" class="InductiveConstructor">eAnd</a> <a id="2169" href="V2.UntypedInterpreter.html#2169" class="Bound">e₁</a> <a id="2172" href="V2.UntypedInterpreter.html#2172" class="Bound">e₂</a><a id="2174" class="Symbol">)</a> <a id="2176" class="Symbol">=</a> <a id="2178" href="Function.html#3662" class="Function Operator">case</a> <a id="2183" class="Symbol">(</a><a id="2184" href="V2.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="2189" href="V2.UntypedInterpreter.html#2169" class="Bound">e₁</a> <a id="2192" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2194" href="V2.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="2199" href="V2.UntypedInterpreter.html#2172" class="Bound">e₂</a><a id="2201" class="Symbol">)</a> <a id="2203" href="Function.html#3662" class="Function Operator">of</a> <a id="2206" class="Symbol">λ</a> <a id="2208" class="Keyword">where</a>
    <a id="2218" class="Symbol">(</a><a id="2219" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2224" class="Symbol">(</a><a id="2225" href="V2.UntypedInterpreter.html#342" class="InductiveConstructor">boolV</a> <a id="2231" href="V2.UntypedInterpreter.html#2231" class="Bound">b₁</a><a id="2233" class="Symbol">)</a> <a id="2235" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2237" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2242" class="Symbol">(</a><a id="2243" href="V2.UntypedInterpreter.html#342" class="InductiveConstructor">boolV</a> <a id="2249" href="V2.UntypedInterpreter.html#2249" class="Bound">b₂</a><a id="2251" class="Symbol">))</a> <a id="2254" class="Symbol">→</a> <a id="2256" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2261" class="Symbol">(</a><a id="2262" href="V2.UntypedInterpreter.html#342" class="InductiveConstructor">boolV</a> <a id="2268" class="Symbol">(</a><a id="2269" href="V2.UntypedInterpreter.html#1251" class="Function">bAnd</a> <a id="2274" href="V2.UntypedInterpreter.html#2231" class="Bound">b₁</a> <a id="2277" href="V2.UntypedInterpreter.html#2249" class="Bound">b₂</a><a id="2279" class="Symbol">))</a>
    <a id="2286" class="CatchallClause Symbol">_</a> <a id="2288" class="Symbol">→</a> <a id="2290" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>
  <a id="2300" href="V2.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="2305" class="Symbol">(</a><a id="2306" href="V2.AST.html#806" class="InductiveConstructor">eCond</a> <a id="2312" href="V2.UntypedInterpreter.html#2312" class="Bound">e₁</a> <a id="2315" href="V2.UntypedInterpreter.html#2315" class="Bound">e₂</a> <a id="2318" href="V2.UntypedInterpreter.html#2318" class="Bound">e₃</a><a id="2320" class="Symbol">)</a> <a id="2322" class="Symbol">=</a> <a id="2324" href="Function.html#3662" class="Function Operator">case</a> <a id="2329" class="Symbol">(</a><a id="2330" href="V2.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="2335" href="V2.UntypedInterpreter.html#2312" class="Bound">e₁</a><a id="2337" class="Symbol">)</a> <a id="2339" href="Function.html#3662" class="Function Operator">of</a> <a id="2342" class="Symbol">λ</a> <a id="2344" class="Keyword">where</a>
    <a id="2354" class="Symbol">(</a><a id="2355" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2360" class="Symbol">(</a><a id="2361" href="V2.UntypedInterpreter.html#342" class="InductiveConstructor">boolV</a> <a id="2367" href="V2.UntypedInterpreter.html#2367" class="Bound">b</a><a id="2368" class="Symbol">))</a> <a id="2371" class="Symbol">→</a> <a id="2373" href="V2.UntypedInterpreter.html#1349" class="Function">bIf</a> <a id="2377" href="V2.UntypedInterpreter.html#2367" class="Bound">b</a> <a id="2379" class="Symbol">(</a><a id="2380" href="V2.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="2385" href="V2.UntypedInterpreter.html#2315" class="Bound">e₂</a><a id="2387" class="Symbol">)</a> <a id="2389" class="Symbol">(</a><a id="2390" href="V2.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="2395" href="V2.UntypedInterpreter.html#2318" class="Bound">e₃</a><a id="2397" class="Symbol">)</a>
    <a id="2403" class="CatchallClause Symbol">_</a> <a id="2405" class="Symbol">→</a> <a id="2407" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>


<a id="2417" class="Keyword">open</a> <a id="2422" href="V2.UntypedInterpreter.html#1618" class="Module">EvalExp</a>

<a id="2431" class="Comment">-- The execution of a declaration adds a new binding</a>
<a id="2484" class="Comment">-- to the environment.</a>

<a id="execDecl"></a><a id="2508" href="V2.UntypedInterpreter.html#2508" class="Function">execDecl</a> <a id="2517" class="Symbol">:</a> <a id="2519" href="V2.AST.html#951" class="Record">Decl</a> <a id="2524" class="Symbol">→</a> <a id="2526" href="V2.UntypedInterpreter.html#525" class="Function">Env</a> <a id="2530" class="Symbol">→</a> <a id="2532" href="Data.Maybe.Base.html#795" class="Datatype">Maybe</a> <a id="2538" href="V2.UntypedInterpreter.html#525" class="Function">Env</a>
<a id="2542" href="V2.UntypedInterpreter.html#2508" class="Function">execDecl</a> <a id="2551" class="Symbol">(</a><a id="2552" href="V2.AST.html#982" class="InductiveConstructor">dInit</a> <a id="2558" href="V2.UntypedInterpreter.html#2558" class="Bound">t</a> <a id="2560" href="V2.UntypedInterpreter.html#2560" class="Bound">x</a> <a id="2562" href="V2.UntypedInterpreter.html#2562" class="Bound">e</a><a id="2563" class="Symbol">)</a> <a id="2565" href="V2.UntypedInterpreter.html#2565" class="Bound">ρ</a> <a id="2567" class="Symbol">=</a> <a id="2569" href="Function.html#3662" class="Function Operator">case</a> <a id="2574" href="V2.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="2579" href="V2.UntypedInterpreter.html#2565" class="Bound">ρ</a> <a id="2581" href="V2.UntypedInterpreter.html#2562" class="Bound">e</a> <a id="2583" href="Function.html#3662" class="Function Operator">of</a> <a id="2586" class="Symbol">λ</a> <a id="2588" class="Keyword">where</a>
  <a id="2596" class="Symbol">(</a><a id="2597" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2602" href="V2.UntypedInterpreter.html#2602" class="Bound">v</a><a id="2603" class="Symbol">)</a> <a id="2605" class="Symbol">→</a> <a id="2607" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2612" class="Symbol">((</a><a id="2614" href="V2.UntypedInterpreter.html#2560" class="Bound">x</a> <a id="2616" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2618" href="V2.UntypedInterpreter.html#2602" class="Bound">v</a><a id="2619" class="Symbol">)</a> <a id="2621" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="2623" href="V2.UntypedInterpreter.html#2565" class="Bound">ρ</a><a id="2624" class="Symbol">)</a>
  <a id="2628" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>  <a id="2637" class="Symbol">→</a> <a id="2639" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>

<a id="2648" class="Comment">-- Execution of declarations returns the extended environment.</a>

<a id="execDecls"></a><a id="2712" href="V2.UntypedInterpreter.html#2712" class="Function">execDecls</a> <a id="2722" class="Symbol">:</a> <a id="2724" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="2729" href="V2.AST.html#951" class="Record">Decl</a> <a id="2734" class="Symbol">→</a> <a id="2736" href="V2.UntypedInterpreter.html#525" class="Function">Env</a> <a id="2740" class="Symbol">→</a> <a id="2742" href="Data.Maybe.Base.html#795" class="Datatype">Maybe</a> <a id="2748" href="V2.UntypedInterpreter.html#525" class="Function">Env</a>
<a id="2752" href="V2.UntypedInterpreter.html#2712" class="Function">execDecls</a> <a id="2762" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="2765" href="V2.UntypedInterpreter.html#2765" class="Bound">ρ</a> <a id="2767" class="Symbol">=</a> <a id="2769" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2774" href="V2.UntypedInterpreter.html#2765" class="Bound">ρ</a>
<a id="2776" href="V2.UntypedInterpreter.html#2712" class="Function">execDecls</a> <a id="2786" class="Symbol">(</a><a id="2787" href="V2.UntypedInterpreter.html#2787" class="Bound">d</a> <a id="2789" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="2791" href="V2.UntypedInterpreter.html#2791" class="Bound">ds</a><a id="2793" class="Symbol">)</a> <a id="2795" href="V2.UntypedInterpreter.html#2795" class="Bound">ρ</a> <a id="2797" class="Symbol">=</a> <a id="2799" href="Function.html#3662" class="Function Operator">case</a> <a id="2804" href="V2.UntypedInterpreter.html#2508" class="Function">execDecl</a> <a id="2813" href="V2.UntypedInterpreter.html#2787" class="Bound">d</a> <a id="2815" href="V2.UntypedInterpreter.html#2795" class="Bound">ρ</a> <a id="2817" href="Function.html#3662" class="Function Operator">of</a> <a id="2820" class="Symbol">λ</a> <a id="2822" class="Keyword">where</a>
  <a id="2830" class="Symbol">(</a><a id="2831" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2836" href="V2.UntypedInterpreter.html#2836" class="Bound">ρ&#39;</a><a id="2838" class="Symbol">)</a> <a id="2840" class="Symbol">→</a> <a id="2842" href="V2.UntypedInterpreter.html#2712" class="Function">execDecls</a> <a id="2852" href="V2.UntypedInterpreter.html#2791" class="Bound">ds</a> <a id="2855" href="V2.UntypedInterpreter.html#2836" class="Bound">ρ&#39;</a>
  <a id="2860" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>   <a id="2870" class="Symbol">→</a> <a id="2872" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>

<a id="2881" class="Comment">-- We evaluate a program by first executing the declarations,</a>
<a id="2943" class="Comment">-- and then evaluating the main expression.</a>

<a id="evalPrg"></a><a id="2988" href="V2.UntypedInterpreter.html#2988" class="Function">evalPrg</a> <a id="2996" class="Symbol">:</a> <a id="2998" href="V2.AST.html#1134" class="Record">Program</a> <a id="3006" class="Symbol">→</a> <a id="3008" href="Data.Maybe.Base.html#795" class="Datatype">Maybe</a> <a id="3014" href="Agda.Builtin.Int.html#219" class="Datatype">ℤ</a>
<a id="3016" href="V2.UntypedInterpreter.html#2988" class="Function">evalPrg</a> <a id="3024" class="Symbol">(</a><a id="3025" href="V2.AST.html#1168" class="InductiveConstructor">program</a> <a id="3033" href="V2.UntypedInterpreter.html#3033" class="Bound">ds</a> <a id="3036" href="V2.UntypedInterpreter.html#3036" class="Bound">e</a><a id="3037" class="Symbol">)</a> <a id="3039" class="Symbol">=</a> <a id="3041" href="Function.html#3662" class="Function Operator">case</a> <a id="3046" href="V2.UntypedInterpreter.html#2712" class="Function">execDecls</a> <a id="3056" href="V2.UntypedInterpreter.html#3033" class="Bound">ds</a> <a id="3059" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="3062" href="Function.html#3662" class="Function Operator">of</a> <a id="3065" class="Symbol">λ</a> <a id="3067" class="Keyword">where</a>
  <a id="3075" class="Symbol">(</a><a id="3076" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="3081" href="V2.UntypedInterpreter.html#3081" class="Bound">ρ</a><a id="3082" class="Symbol">)</a> <a id="3084" class="Symbol">→</a> <a id="3086" href="Function.html#3662" class="Function Operator">case</a> <a id="3091" href="V2.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="3096" href="V2.UntypedInterpreter.html#3081" class="Bound">ρ</a> <a id="3098" href="V2.UntypedInterpreter.html#3036" class="Bound">e</a> <a id="3100" href="Function.html#3662" class="Function Operator">of</a> <a id="3103" class="Symbol">λ</a> <a id="3105" class="Keyword">where</a>
    <a id="3115" class="Symbol">(</a><a id="3116" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="3121" class="Symbol">(</a><a id="3122" href="V2.UntypedInterpreter.html#318" class="InductiveConstructor">intV</a> <a id="3127" href="V2.UntypedInterpreter.html#3127" class="Bound">v</a><a id="3128" class="Symbol">))</a> <a id="3131" class="Symbol">→</a> <a id="3133" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="3138" href="V2.UntypedInterpreter.html#3127" class="Bound">v</a>
    <a id="3144" class="CatchallClause Symbol">_</a>               <a id="3160" class="Symbol">→</a> <a id="3162" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>
  <a id="3172" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>   <a id="3182" class="Symbol">→</a> <a id="3184" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>
</pre></body></html>