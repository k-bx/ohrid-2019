<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>V2.TypeChecker</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">-- Type checker for the WHILE language.</a>

<a id="42" class="Symbol">{-#</a> <a id="46" class="Keyword">OPTIONS</a> <a id="54" class="Pragma">--postfix-projections</a> <a id="76" class="Symbol">#-}</a>

<a id="81" class="Keyword">module</a> <a id="88" href="V2.TypeChecker.html" class="Module">V2.TypeChecker</a> <a id="103" class="Keyword">where</a>

<a id="110" class="Keyword">open</a> <a id="115" class="Keyword">import</a> <a id="122" href="Library.html" class="Module">Library</a>

<a id="131" class="Keyword">import</a> <a id="138" href="V2.AST.html" class="Module">V2.AST</a> <a id="145" class="Symbol">as</a> <a id="148" class="Module">A</a>
<a id="150" class="Keyword">open</a> <a id="155" class="Keyword">import</a> <a id="162" href="V2.WellTypedSyntax.html" class="Module">V2.WellTypedSyntax</a>

<a id="182" class="Comment">-- Names as coming from the abstract syntax are just strings.</a>

<a id="Name"></a><a id="245" href="V2.TypeChecker.html#245" class="Function">Name</a> <a id="250" class="Symbol">=</a> <a id="252" href="Agda.Builtin.String.html#247" class="Postulate">String</a>

<a id="idToName"></a><a id="260" href="V2.TypeChecker.html#260" class="Function">idToName</a> <a id="269" class="Symbol">:</a> <a id="271" href="V2.AST.html#282" class="Datatype">A.Id</a> <a id="276" class="Symbol">→</a> <a id="278" href="V2.TypeChecker.html#245" class="Function">Name</a>
<a id="283" href="V2.TypeChecker.html#260" class="Function">idToName</a> <a id="292" class="Symbol">(</a><a id="293" href="V2.AST.html#299" class="InductiveConstructor">A.mkId</a> <a id="300" href="V2.TypeChecker.html#300" class="Bound">x</a><a id="301" class="Symbol">)</a> <a id="303" class="Symbol">=</a> <a id="305" href="Agda.Builtin.String.html#345" class="Primitive">String.fromList</a> <a id="321" href="V2.TypeChecker.html#300" class="Bound">x</a>

<a id="324" class="Comment">-- Local context for the type checker.</a>

<a id="TCCxt"></a><a id="364" href="V2.TypeChecker.html#364" class="Function">TCCxt</a> <a id="370" class="Symbol">:</a> <a id="372" class="Symbol">(</a><a id="373" href="V2.TypeChecker.html#373" class="Bound">Γ</a> <a id="375" class="Symbol">:</a> <a id="377" href="V2.WellTypedSyntax.html#255" class="Function">Cxt</a><a id="380" class="Symbol">)</a> <a id="382" class="Symbol">→</a> <a id="384" class="PrimitiveType">Set</a>
<a id="388" href="V2.TypeChecker.html#364" class="Function">TCCxt</a> <a id="394" href="V2.TypeChecker.html#394" class="Bound">Γ</a> <a id="396" class="Symbol">=</a> <a id="398" href="Library.List.html#1325" class="Function">AssocList</a> <a id="408" href="V2.TypeChecker.html#245" class="Function">Name</a> <a id="413" href="V2.TypeChecker.html#394" class="Bound">Γ</a>

<a id="416" class="Comment">-- Querying the local context.</a>

<a id="448" class="Comment">-- Type errors.</a>
<a id="464" class="Comment">--</a>
<a id="467" class="Comment">-- Currently, these errors do not carry enough evidence that</a>
<a id="528" class="Comment">-- something is wrong.  The type checker does not produce</a>
<a id="586" class="Comment">-- evidence of ill-typedness in case of failure,</a>
<a id="635" class="Comment">-- only of well-typedness in case of success.</a>

<a id="682" class="Keyword">data</a> <a id="TypeError"></a><a id="687" href="V2.TypeChecker.html#687" class="Datatype">TypeError</a> <a id="697" class="Symbol">:</a> <a id="699" class="PrimitiveType">Set</a> <a id="703" class="Keyword">where</a>
  <a id="TypeError.unboundVariable"></a><a id="711" href="V2.TypeChecker.html#711" class="InductiveConstructor">unboundVariable</a>        <a id="734" class="Symbol">:</a> <a id="736" href="V2.TypeChecker.html#245" class="Function">Name</a> <a id="741" class="Symbol">→</a> <a id="743" href="V2.TypeChecker.html#687" class="Datatype">TypeError</a>
  <a id="TypeError.typeMismatch"></a><a id="755" href="V2.TypeChecker.html#755" class="InductiveConstructor">typeMismatch</a>           <a id="778" class="Symbol">:</a> <a id="780" class="Symbol">(</a><a id="781" href="V2.TypeChecker.html#781" class="Bound">tinf</a> <a id="786" href="V2.TypeChecker.html#786" class="Bound">texp</a> <a id="791" class="Symbol">:</a> <a id="793" href="V2.AST.html#372" class="Datatype">Type</a><a id="797" class="Symbol">)</a>  <a id="800" class="Symbol">→</a> <a id="802" href="V2.TypeChecker.html#781" class="Bound">tinf</a> <a id="807" href="Relation.Binary.PropositionalEquality.Core.html#799" class="Function Operator">≢</a> <a id="809" href="V2.TypeChecker.html#786" class="Bound">texp</a> <a id="814" class="Symbol">→</a> <a id="816" href="V2.TypeChecker.html#687" class="Datatype">TypeError</a>

<a id="827" class="Keyword">instance</a>
  <a id="PrintError"></a><a id="838" href="V2.TypeChecker.html#838" class="Function">PrintError</a> <a id="849" class="Symbol">:</a> <a id="851" href="Library.Print.html#196" class="Record">Print</a> <a id="857" href="V2.TypeChecker.html#687" class="Datatype">TypeError</a>
  <a id="869" href="Library.Print.html#244" class="Field">print</a> <a id="875" class="Symbol">{{</a><a id="877" href="V2.TypeChecker.html#838" class="Function">PrintError</a><a id="887" class="Symbol">}}</a> <a id="890" class="Symbol">=</a> <a id="892" class="Symbol">λ</a> <a id="894" class="Keyword">where</a>
    <a id="904" class="Symbol">(</a><a id="905" href="V2.TypeChecker.html#711" class="InductiveConstructor">unboundVariable</a> <a id="921" href="V2.TypeChecker.html#921" class="Bound">x</a><a id="922" class="Symbol">)</a>        <a id="931" class="Symbol">→</a> <a id="933" class="String">&quot;unbound variable &quot;</a> <a id="953" href="Data.String.Base.html#1744" class="Function Operator">String.++</a> <a id="963" href="V2.TypeChecker.html#921" class="Bound">x</a>
    <a id="969" class="Symbol">(</a><a id="970" href="V2.TypeChecker.html#755" class="InductiveConstructor">typeMismatch</a> <a id="983" href="V2.TypeChecker.html#983" class="Bound">tinf</a> <a id="988" href="V2.TypeChecker.html#988" class="Bound">texp</a> <a id="993" class="Symbol">_)</a> <a id="996" class="Symbol">→</a> <a id="998" href="Data.String.Base.html#1932" class="Function">String.concat</a> <a id="1012" href="Function.html#1645" class="Function Operator">$</a>
      <a id="1020" class="String">&quot;type mismatch: expected &quot;</a> <a id="1047" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1049" href="Library.Print.html#244" class="Field">print</a> <a id="1055" href="V2.TypeChecker.html#988" class="Bound">texp</a> <a id="1060" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a>
      <a id="1068" class="String">&quot;, but inferred &quot;</a> <a id="1086" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1088" href="Library.Print.html#244" class="Field">print</a> <a id="1094" href="V2.TypeChecker.html#983" class="Bound">tinf</a> <a id="1099" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1101" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>

<a id="1105" class="Comment">-- Type error monad.</a>

<a id="1127" class="Keyword">open</a> <a id="1132" href="Library.Error.html#134" class="Module">ErrorMonad</a> <a id="1143" class="Symbol">{</a><a id="1144" class="Argument">E</a> <a id="1146" class="Symbol">=</a> <a id="1148" href="V2.TypeChecker.html#687" class="Datatype">TypeError</a><a id="1157" class="Symbol">}</a>

<a id="1160" class="Comment">-- Checking expressions</a>
<a id="1184" class="Comment">---------------------------------------------------------------------------</a>

<a id="1261" class="Comment">-- During checking of expressions, the context is fixed.</a>

<a id="1319" class="Keyword">module</a> <a id="CheckExpressions"></a><a id="1326" href="V2.TypeChecker.html#1326" class="Module">CheckExpressions</a> <a id="1343" class="Symbol">{</a><a id="1344" href="V2.TypeChecker.html#1344" class="Bound">Γ</a> <a id="1346" class="Symbol">:</a> <a id="1348" href="V2.WellTypedSyntax.html#255" class="Function">Cxt</a><a id="1351" class="Symbol">}</a> <a id="1353" class="Symbol">(</a><a id="1354" href="V2.TypeChecker.html#1354" class="Bound">γ</a> <a id="1356" class="Symbol">:</a> <a id="1358" href="V2.TypeChecker.html#364" class="Function">TCCxt</a> <a id="1364" href="V2.TypeChecker.html#1344" class="Bound">Γ</a><a id="1365" class="Symbol">)</a> <a id="1367" class="Keyword">where</a>

  <a id="1376" class="Comment">-- Environment.</a>

  <a id="CheckExpressions.lookupVar"></a><a id="1395" href="V2.TypeChecker.html#1395" class="Function">lookupVar</a> <a id="1405" class="Symbol">:</a> <a id="1407" class="Symbol">(</a><a id="1408" href="V2.TypeChecker.html#1408" class="Bound">x</a> <a id="1410" class="Symbol">:</a> <a id="1412" href="V2.TypeChecker.html#245" class="Function">Name</a><a id="1416" class="Symbol">)</a> <a id="1418" class="Symbol">→</a> <a id="1420" href="Library.Error.html#170" class="Function">Error</a> <a id="1426" class="Symbol">(</a><a id="1427" href="Data.Product.html#1364" class="Function">∃</a> <a id="1429" class="Symbol">λ</a> <a id="1431" href="V2.TypeChecker.html#1431" class="Bound">t</a> <a id="1433" class="Symbol">→</a> <a id="1435" href="V2.WellTypedSyntax.html#272" class="Function">Var</a> <a id="1439" href="V2.TypeChecker.html#1344" class="Bound">Γ</a> <a id="1441" href="V2.TypeChecker.html#1431" class="Bound">t</a><a id="1442" class="Symbol">)</a>
  <a id="1446" href="V2.TypeChecker.html#1395" class="Function">lookupVar</a> <a id="1456" href="V2.TypeChecker.html#1456" class="Bound">x</a> <a id="1458" class="Symbol">=</a>
    <a id="1464" href="Function.html#3662" class="Function Operator">case</a> <a id="1469" href="Library.List.html#1758" class="Function Operator">?↦</a> <a id="1472" href="V2.TypeChecker.html#1456" class="Bound">x</a> <a id="1474" href="Library.List.html#1758" class="Function Operator">∈</a> <a id="1476" href="V2.TypeChecker.html#1354" class="Bound">γ</a> <a id="1478" href="Function.html#3662" class="Function Operator">of</a> <a id="1481" class="Symbol">λ</a> <a id="1483" class="Keyword">where</a>
      <a id="1495" class="Symbol">(</a><a id="1496" href="Relation.Nullary.html#641" class="InductiveConstructor">yes</a> <a id="1500" class="Symbol">(</a><a id="1501" href="V2.TypeChecker.html#1501" class="Bound">t</a> <a id="1503" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1505" href="V2.TypeChecker.html#1505" class="Bound">x&#39;</a> <a id="1508" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1510" class="Symbol">_))</a> <a id="1514" class="Symbol">→</a> <a id="1516" href="Library.Monad.html#1110" class="Function">return</a> <a id="1523" class="Symbol">(</a><a id="1524" href="V2.TypeChecker.html#1501" class="Bound">t</a> <a id="1526" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1528" href="V2.TypeChecker.html#1505" class="Bound">x&#39;</a><a id="1530" class="Symbol">)</a>
      <a id="1538" class="Symbol">(</a><a id="1539" href="Relation.Nullary.html#668" class="InductiveConstructor">no</a> <a id="1542" href="V2.TypeChecker.html#1542" class="Bound">¬p</a><a id="1544" class="Symbol">)</a>            <a id="1557" class="Symbol">→</a> <a id="1559" href="Library.Error.html#912" class="Function">throwError</a> <a id="1570" href="Function.html#1645" class="Function Operator">$</a> <a id="1572" href="V2.TypeChecker.html#711" class="InductiveConstructor">unboundVariable</a> <a id="1588" href="V2.TypeChecker.html#1456" class="Bound">x</a>

  <a id="1593" class="Comment">-- The expression checker.</a>

  <a id="1623" class="Keyword">mutual</a>

    <a id="1635" class="Comment">-- Type inference.</a>

    <a id="CheckExpressions.inferExp"></a><a id="1659" href="V2.TypeChecker.html#1659" class="Function">inferExp</a> <a id="1668" class="Symbol">:</a> <a id="1670" class="Symbol">(</a><a id="1671" href="V2.TypeChecker.html#1671" class="Bound">e</a> <a id="1673" class="Symbol">:</a> <a id="1675" href="V2.AST.html#584" class="Datatype">A.Exp</a><a id="1680" class="Symbol">)</a> <a id="1682" class="Symbol">→</a> <a id="1684" href="Library.Error.html#170" class="Function">Error</a> <a id="1690" class="Symbol">(</a><a id="1691" href="Data.Product.html#1364" class="Function">∃</a> <a id="1693" class="Symbol">λ</a> <a id="1695" class="Symbol">(</a><a id="1696" href="V2.TypeChecker.html#1696" class="Bound">t</a> <a id="1698" class="Symbol">:</a> <a id="1700" href="V2.AST.html#372" class="Datatype">Type</a><a id="1704" class="Symbol">)</a> <a id="1706" class="Symbol">→</a> <a id="1708" href="V2.WellTypedSyntax.html#505" class="Datatype">Exp</a> <a id="1712" href="V2.TypeChecker.html#1344" class="Bound">Γ</a> <a id="1714" href="V2.TypeChecker.html#1696" class="Bound">t</a><a id="1715" class="Symbol">)</a>

    <a id="1722" href="V2.TypeChecker.html#1659" class="Function">inferExp</a> <a id="1731" class="Symbol">(</a><a id="1732" href="V2.AST.html#647" class="InductiveConstructor">A.eInt</a> <a id="1739" href="V2.TypeChecker.html#1739" class="Bound">i</a><a id="1740" class="Symbol">)</a>  <a id="1743" class="Symbol">=</a> <a id="1745" href="Library.Monad.html#1110" class="Function">return</a> <a id="1752" class="Symbol">(</a><a id="1753" href="V2.AST.html#396" class="InductiveConstructor">int</a>  <a id="1758" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1760" href="V2.WellTypedSyntax.html#555" class="InductiveConstructor">eInt</a>  <a id="1766" href="V2.TypeChecker.html#1739" class="Bound">i</a><a id="1767" class="Symbol">)</a>
    <a id="1773" href="V2.TypeChecker.html#1659" class="Function">inferExp</a> <a id="1782" class="Symbol">(</a><a id="1783" href="V2.AST.html#692" class="InductiveConstructor">A.eBool</a> <a id="1791" href="V2.TypeChecker.html#1791" class="Bound">b</a><a id="1792" class="Symbol">)</a> <a id="1794" class="Symbol">=</a> <a id="1796" href="Library.Monad.html#1110" class="Function">return</a> <a id="1803" class="Symbol">(</a><a id="1804" href="V2.AST.html#391" class="InductiveConstructor">bool</a> <a id="1809" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1811" href="V2.WellTypedSyntax.html#617" class="InductiveConstructor">eBool</a> <a id="1817" href="V2.TypeChecker.html#1791" class="Bound">b</a><a id="1818" class="Symbol">)</a>

    <a id="1825" href="V2.TypeChecker.html#1659" class="Function">inferExp</a> <a id="1834" class="Symbol">(</a><a id="1835" href="V2.AST.html#602" class="InductiveConstructor">A.eId</a> <a id="1841" href="V2.TypeChecker.html#1841" class="Bound">x</a><a id="1842" class="Symbol">)</a> <a id="1844" class="Symbol">=</a> <a id="1846" class="Keyword">do</a>
      <a id="1855" class="Symbol">(</a><a id="1856" href="V2.TypeChecker.html#1856" class="Bound">t</a> <a id="1858" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1860" href="V2.TypeChecker.html#1860" class="Bound">x&#39;</a><a id="1862" class="Symbol">)</a> <a id="1864" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="1866" href="V2.TypeChecker.html#1395" class="Function">lookupVar</a> <a id="1876" class="Symbol">(</a><a id="1877" href="V2.TypeChecker.html#260" class="Function">idToName</a> <a id="1886" href="V2.TypeChecker.html#1841" class="Bound">x</a><a id="1887" class="Symbol">)</a>
      <a id="1895" href="Library.Monad.html#1110" class="Function">return</a> <a id="1902" class="Symbol">(</a><a id="1903" href="V2.TypeChecker.html#1856" class="Bound">t</a> <a id="1905" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1907" href="V2.WellTypedSyntax.html#773" class="InductiveConstructor">eVar</a> <a id="1912" href="V2.TypeChecker.html#1860" class="Bound">x&#39;</a><a id="1914" class="Symbol">)</a>

    <a id="1921" href="V2.TypeChecker.html#1659" class="Function">inferExp</a> <a id="1930" class="Symbol">(</a><a id="1931" href="V2.AST.html#737" class="InductiveConstructor">A.ePlus</a>  <a id="1940" href="V2.TypeChecker.html#1940" class="Bound">e₁</a> <a id="1943" href="V2.TypeChecker.html#1943" class="Bound">e₂</a><a id="1945" class="Symbol">)</a> <a id="1947" class="Symbol">=</a> <a id="1949" href="V2.TypeChecker.html#2415" class="Function">inferOp</a> <a id="1957" href="V2.WellTypedSyntax.html#387" class="InductiveConstructor">plus</a>  <a id="1963" href="V2.TypeChecker.html#1940" class="Bound">e₁</a> <a id="1966" href="V2.TypeChecker.html#1943" class="Bound">e₂</a>

    <a id="1974" href="V2.TypeChecker.html#1659" class="Function">inferExp</a> <a id="1983" class="Symbol">(</a><a id="1984" href="V2.AST.html#782" class="InductiveConstructor">A.eGt</a>    <a id="1993" href="V2.TypeChecker.html#1993" class="Bound">e₁</a> <a id="1996" href="V2.TypeChecker.html#1996" class="Bound">e₂</a><a id="1998" class="Symbol">)</a> <a id="2000" class="Symbol">=</a> <a id="2002" href="V2.TypeChecker.html#2415" class="Function">inferOp</a> <a id="2010" href="V2.WellTypedSyntax.html#409" class="InductiveConstructor">gt</a>    <a id="2016" href="V2.TypeChecker.html#1993" class="Bound">e₁</a> <a id="2019" href="V2.TypeChecker.html#1996" class="Bound">e₂</a>

    <a id="2027" href="V2.TypeChecker.html#1659" class="Function">inferExp</a> <a id="2036" class="Symbol">(</a><a id="2037" href="V2.AST.html#827" class="InductiveConstructor">A.eAnd</a>   <a id="2046" href="V2.TypeChecker.html#2046" class="Bound">e₁</a> <a id="2049" href="V2.TypeChecker.html#2049" class="Bound">e₂</a><a id="2051" class="Symbol">)</a> <a id="2053" class="Symbol">=</a> <a id="2055" href="V2.TypeChecker.html#2415" class="Function">inferOp</a> <a id="2063" href="V2.WellTypedSyntax.html#432" class="InductiveConstructor">and</a>   <a id="2069" href="V2.TypeChecker.html#2046" class="Bound">e₁</a> <a id="2072" href="V2.TypeChecker.html#2049" class="Bound">e₂</a>

    <a id="2080" class="Comment">-- Type checking.</a>
    <a id="2102" class="Comment">-- Calls inference and checks inferred type against given type.</a>

    <a id="CheckExpressions.checkExp"></a><a id="2171" href="V2.TypeChecker.html#2171" class="Function">checkExp</a> <a id="2180" class="Symbol">:</a> <a id="2182" class="Symbol">(</a><a id="2183" href="V2.TypeChecker.html#2183" class="Bound">e</a> <a id="2185" class="Symbol">:</a> <a id="2187" href="V2.AST.html#584" class="Datatype">A.Exp</a><a id="2192" class="Symbol">)</a> <a id="2194" class="Symbol">(</a><a id="2195" href="V2.TypeChecker.html#2195" class="Bound">t</a> <a id="2197" class="Symbol">:</a> <a id="2199" href="V2.AST.html#372" class="Datatype">Type</a><a id="2203" class="Symbol">)</a> <a id="2205" class="Symbol">→</a> <a id="2207" href="Library.Error.html#170" class="Function">Error</a> <a id="2213" class="Symbol">(</a><a id="2214" href="V2.WellTypedSyntax.html#505" class="Datatype">Exp</a> <a id="2218" href="V2.TypeChecker.html#1344" class="Bound">Γ</a> <a id="2220" href="V2.TypeChecker.html#2195" class="Bound">t</a><a id="2221" class="Symbol">)</a>
    <a id="2227" href="V2.TypeChecker.html#2171" class="Function">checkExp</a> <a id="2236" href="V2.TypeChecker.html#2236" class="Bound">e</a> <a id="2238" href="V2.TypeChecker.html#2238" class="Bound">t</a> <a id="2240" class="Symbol">=</a> <a id="2242" class="Keyword">do</a>
      <a id="2251" class="Symbol">(</a><a id="2252" href="V2.TypeChecker.html#2252" class="Bound">t&#39;</a> <a id="2255" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2257" href="V2.TypeChecker.html#2257" class="Bound">e&#39;</a><a id="2259" class="Symbol">)</a> <a id="2261" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="2263" href="V2.TypeChecker.html#1659" class="Function">inferExp</a> <a id="2272" href="V2.TypeChecker.html#2236" class="Bound">e</a>
      <a id="2280" href="Function.html#3662" class="Function Operator">case</a> <a id="2285" href="V2.TypeChecker.html#2252" class="Bound">t&#39;</a> <a id="2288" href="Library.Eq.html#627" class="Field Operator">≟</a> <a id="2290" href="V2.TypeChecker.html#2238" class="Bound">t</a> <a id="2292" href="Function.html#3662" class="Function Operator">of</a> <a id="2295" class="Symbol">λ</a> <a id="2297" class="Keyword">where</a>
        <a id="2311" class="Symbol">(</a><a id="2312" href="Relation.Nullary.html#641" class="InductiveConstructor">yes</a> <a id="2316" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="2320" class="Symbol">)</a> <a id="2322" class="Symbol">→</a> <a id="2324" href="Library.Monad.html#1110" class="Function">return</a> <a id="2331" href="V2.TypeChecker.html#2257" class="Bound">e&#39;</a>
        <a id="2342" class="Symbol">(</a><a id="2343" href="Relation.Nullary.html#668" class="InductiveConstructor">no</a>  <a id="2347" href="V2.TypeChecker.html#2347" class="Bound">t&#39;≢t</a><a id="2351" class="Symbol">)</a> <a id="2353" class="Symbol">→</a> <a id="2355" href="Library.Error.html#912" class="Function">throwError</a> <a id="2366" class="Symbol">(</a><a id="2367" href="V2.TypeChecker.html#755" class="InductiveConstructor">typeMismatch</a> <a id="2380" href="V2.TypeChecker.html#2252" class="Bound">t&#39;</a> <a id="2383" href="V2.TypeChecker.html#2238" class="Bound">t</a> <a id="2385" href="V2.TypeChecker.html#2347" class="Bound">t&#39;≢t</a><a id="2389" class="Symbol">)</a>

    <a id="2396" class="Comment">-- Operators.</a>

    <a id="CheckExpressions.inferOp"></a><a id="2415" href="V2.TypeChecker.html#2415" class="Function">inferOp</a> <a id="2423" class="Symbol">:</a> <a id="2425" class="Symbol">∀{</a><a id="2427" href="V2.TypeChecker.html#2427" class="Bound">t</a> <a id="2429" href="V2.TypeChecker.html#2429" class="Bound">t&#39;</a><a id="2431" class="Symbol">}</a> <a id="2433" class="Symbol">(</a><a id="2434" href="V2.TypeChecker.html#2434" class="Bound">op</a> <a id="2437" class="Symbol">:</a> <a id="2439" href="V2.WellTypedSyntax.html#349" class="Datatype">Op</a> <a id="2442" href="V2.TypeChecker.html#2427" class="Bound">t</a> <a id="2444" href="V2.TypeChecker.html#2429" class="Bound">t&#39;</a><a id="2446" class="Symbol">)</a> <a id="2448" class="Symbol">(</a><a id="2449" href="V2.TypeChecker.html#2449" class="Bound">e₁</a> <a id="2452" href="V2.TypeChecker.html#2452" class="Bound">e₂</a> <a id="2455" class="Symbol">:</a> <a id="2457" href="V2.AST.html#584" class="Datatype">A.Exp</a><a id="2462" class="Symbol">)</a> <a id="2464" class="Symbol">→</a> <a id="2466" href="Library.Error.html#170" class="Function">Error</a> <a id="2472" class="Symbol">(</a><a id="2473" href="Data.Product.html#1364" class="Function">∃</a> <a id="2475" class="Symbol">λ</a> <a id="2477" href="V2.TypeChecker.html#2477" class="Bound">t</a> <a id="2479" class="Symbol">→</a> <a id="2481" href="V2.WellTypedSyntax.html#505" class="Datatype">Exp</a> <a id="2485" href="V2.TypeChecker.html#1344" class="Bound">Γ</a> <a id="2487" href="V2.TypeChecker.html#2477" class="Bound">t</a><a id="2488" class="Symbol">)</a>
    <a id="2494" href="V2.TypeChecker.html#2415" class="Function">inferOp</a> <a id="2502" class="Symbol">{</a><a id="2503" href="V2.TypeChecker.html#2503" class="Bound">t</a><a id="2504" class="Symbol">}</a> <a id="2506" class="Symbol">{</a><a id="2507" href="V2.TypeChecker.html#2507" class="Bound">t&#39;</a><a id="2509" class="Symbol">}</a> <a id="2511" href="V2.TypeChecker.html#2511" class="Bound">op</a> <a id="2514" href="V2.TypeChecker.html#2514" class="Bound">e₁</a> <a id="2517" href="V2.TypeChecker.html#2517" class="Bound">e₂</a> <a id="2520" class="Symbol">=</a> <a id="2522" class="Keyword">do</a>
      <a id="2531" href="V2.TypeChecker.html#2531" class="Bound">e₁&#39;</a> <a id="2535" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="2537" href="V2.TypeChecker.html#2171" class="Function">checkExp</a> <a id="2546" href="V2.TypeChecker.html#2514" class="Bound">e₁</a> <a id="2549" href="V2.TypeChecker.html#2503" class="Bound">t</a>
      <a id="2557" href="V2.TypeChecker.html#2557" class="Bound">e₂&#39;</a> <a id="2561" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="2563" href="V2.TypeChecker.html#2171" class="Function">checkExp</a> <a id="2572" href="V2.TypeChecker.html#2517" class="Bound">e₂</a> <a id="2575" href="V2.TypeChecker.html#2503" class="Bound">t</a>
      <a id="2583" href="Library.Monad.html#1110" class="Function">return</a> <a id="2590" class="Symbol">(</a><a id="2591" href="V2.TypeChecker.html#2507" class="Bound">t&#39;</a> <a id="2594" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2596" href="V2.WellTypedSyntax.html#696" class="InductiveConstructor">eOp</a> <a id="2600" href="V2.TypeChecker.html#2511" class="Bound">op</a> <a id="2603" href="V2.TypeChecker.html#2531" class="Bound">e₁&#39;</a> <a id="2607" href="V2.TypeChecker.html#2557" class="Bound">e₂&#39;</a><a id="2610" class="Symbol">)</a>

  <a id="2615" class="Keyword">mutual</a>

    <a id="2627" class="Comment">-- Checking a single statement.</a>

    <a id="CheckExpressions.checkStm"></a><a id="2664" href="V2.TypeChecker.html#2664" class="Function">checkStm</a> <a id="2673" class="Symbol">:</a> <a id="2675" class="Symbol">(</a><a id="2676" href="V2.TypeChecker.html#2676" class="Bound">s</a> <a id="2678" class="Symbol">:</a> <a id="2680" href="V2.AST.html#1154" class="Datatype">A.Stm</a><a id="2685" class="Symbol">)</a> <a id="2687" class="Symbol">→</a> <a id="2689" href="Library.Error.html#170" class="Function">Error</a> <a id="2695" class="Symbol">(</a><a id="2696" href="V2.WellTypedSyntax.html#1132" class="Datatype">Stm</a> <a id="2700" href="V2.TypeChecker.html#1344" class="Bound">Γ</a><a id="2701" class="Symbol">)</a>

    <a id="2708" href="V2.TypeChecker.html#2664" class="Function">checkStm</a> <a id="2717" class="Symbol">(</a><a id="2718" href="V2.AST.html#1172" class="InductiveConstructor">A.sAss</a> <a id="2725" href="V2.TypeChecker.html#2725" class="Bound">x</a> <a id="2727" href="V2.TypeChecker.html#2727" class="Bound">e</a><a id="2728" class="Symbol">)</a> <a id="2730" class="Symbol">=</a> <a id="2732" class="Keyword">do</a>
      <a id="2741" class="Symbol">(</a><a id="2742" href="V2.TypeChecker.html#2742" class="Bound">t</a> <a id="2744" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2746" href="V2.TypeChecker.html#2746" class="Bound">x&#39;</a><a id="2748" class="Symbol">)</a> <a id="2750" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="2752" href="V2.TypeChecker.html#1395" class="Function">lookupVar</a> <a id="2762" class="Symbol">(</a><a id="2763" href="V2.TypeChecker.html#260" class="Function">idToName</a> <a id="2772" href="V2.TypeChecker.html#2725" class="Bound">x</a><a id="2773" class="Symbol">)</a>
      <a id="2781" href="V2.TypeChecker.html#2781" class="Bound">e&#39;</a> <a id="2784" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="2786" href="V2.TypeChecker.html#2171" class="Function">checkExp</a> <a id="2795" href="V2.TypeChecker.html#2727" class="Bound">e</a> <a id="2797" href="V2.TypeChecker.html#2742" class="Bound">t</a>
      <a id="2805" href="Library.Monad.html#1110" class="Function">return</a> <a id="2812" class="Symbol">(</a><a id="2813" href="V2.WellTypedSyntax.html#1162" class="InductiveConstructor">sAss</a> <a id="2818" href="V2.TypeChecker.html#2746" class="Bound">x&#39;</a> <a id="2821" href="V2.TypeChecker.html#2781" class="Bound">e&#39;</a><a id="2823" class="Symbol">)</a>

    <a id="2830" href="V2.TypeChecker.html#2664" class="Function">checkStm</a> <a id="2839" class="Symbol">(</a><a id="2840" href="V2.AST.html#1220" class="InductiveConstructor">A.sWhile</a> <a id="2849" href="V2.TypeChecker.html#2849" class="Bound">e</a> <a id="2851" href="V2.TypeChecker.html#2851" class="Bound">ss</a><a id="2853" class="Symbol">)</a> <a id="2855" class="Symbol">=</a> <a id="2857" class="Keyword">do</a>
      <a id="2866" href="V2.TypeChecker.html#2866" class="Bound">e&#39;</a>  <a id="2870" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="2872" href="V2.TypeChecker.html#2171" class="Function">checkExp</a> <a id="2881" href="V2.TypeChecker.html#2849" class="Bound">e</a> <a id="2883" href="V2.AST.html#391" class="InductiveConstructor">bool</a>
      <a id="2894" href="V2.TypeChecker.html#2894" class="Bound">ss&#39;</a> <a id="2898" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="2900" href="V2.TypeChecker.html#2986" class="Function">checkStms</a> <a id="2910" href="V2.TypeChecker.html#2851" class="Bound">ss</a>
      <a id="2919" href="Library.Monad.html#1110" class="Function">return</a> <a id="2926" class="Symbol">(</a><a id="2927" href="V2.WellTypedSyntax.html#1231" class="InductiveConstructor">sWhile</a> <a id="2934" href="V2.TypeChecker.html#2866" class="Bound">e&#39;</a> <a id="2937" href="V2.TypeChecker.html#2894" class="Bound">ss&#39;</a><a id="2940" class="Symbol">)</a>

    <a id="2947" class="Comment">-- Checking a list of statements.</a>

    <a id="CheckExpressions.checkStms"></a><a id="2986" href="V2.TypeChecker.html#2986" class="Function">checkStms</a> <a id="2996" class="Symbol">:</a> <a id="2998" class="Symbol">(</a><a id="2999" href="V2.TypeChecker.html#2999" class="Bound">ss</a> <a id="3002" class="Symbol">:</a> <a id="3004" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="3009" href="V2.AST.html#1154" class="Datatype">A.Stm</a><a id="3014" class="Symbol">)</a> <a id="3016" class="Symbol">→</a> <a id="3018" href="Library.Error.html#170" class="Function">Error</a> <a id="3024" class="Symbol">(</a><a id="3025" href="V2.WellTypedSyntax.html#1368" class="Function">Stms</a> <a id="3030" href="V2.TypeChecker.html#1344" class="Bound">Γ</a><a id="3031" class="Symbol">)</a>
    <a id="3037" href="V2.TypeChecker.html#2986" class="Function">checkStms</a> <a id="3047" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>       <a id="3056" class="Symbol">=</a> <a id="3058" href="Library.Monad.html#1110" class="Function">return</a> <a id="3065" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>
    <a id="3072" href="V2.TypeChecker.html#2986" class="Function">checkStms</a> <a id="3082" class="Symbol">(</a><a id="3083" href="V2.TypeChecker.html#3083" class="Bound">s</a> <a id="3085" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="3087" href="V2.TypeChecker.html#3087" class="Bound">ss</a><a id="3089" class="Symbol">)</a> <a id="3091" class="Symbol">=</a> <a id="3093" class="Keyword">do</a>
      <a id="3102" href="V2.TypeChecker.html#3102" class="Bound">s&#39;</a> <a id="3105" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="3107" href="V2.TypeChecker.html#2664" class="Function">checkStm</a> <a id="3116" href="V2.TypeChecker.html#3083" class="Bound">s</a>
      <a id="3124" class="Symbol">(</a><a id="3125" href="V2.TypeChecker.html#3102" class="Bound">s&#39;</a> <a id="3128" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷_</a><a id="3130" class="Symbol">)</a> <a id="3132" href="Library.Monad.html#284" class="Function Operator">&lt;$&gt;</a> <a id="3136" href="V2.TypeChecker.html#2986" class="Function">checkStms</a> <a id="3146" href="V2.TypeChecker.html#3087" class="Bound">ss</a>

<a id="3150" class="Comment">-- The declaration checker calls the expression checker.</a>
<a id="3207" class="Comment">-- Exported interface of expression checker:</a>

<a id="3253" class="Comment">-- Monad for checking expressions</a>

<a id="3288" class="Keyword">record</a> <a id="TCExp"></a><a id="3295" href="V2.TypeChecker.html#3295" class="Record">TCExp</a> <a id="3301" href="V2.TypeChecker.html#3301" class="Bound">Γ</a> <a id="3303" class="Symbol">(</a><a id="3304" href="V2.TypeChecker.html#3304" class="Bound">A</a> <a id="3306" class="Symbol">:</a> <a id="3308" class="PrimitiveType">Set</a><a id="3311" class="Symbol">)</a> <a id="3313" class="Symbol">:</a> <a id="3315" class="PrimitiveType">Set</a> <a id="3319" class="Keyword">where</a>
  <a id="3327" class="Keyword">field</a>
    <a id="TCExp.runTCExp"></a><a id="3337" href="V2.TypeChecker.html#3337" class="Field">runTCExp</a> <a id="3346" class="Symbol">:</a> <a id="3348" href="V2.TypeChecker.html#364" class="Function">TCCxt</a> <a id="3354" href="V2.TypeChecker.html#3301" class="Bound">Γ</a> <a id="3356" class="Symbol">→</a> <a id="3358" href="Library.Error.html#170" class="Function">Error</a> <a id="3364" href="V2.TypeChecker.html#3304" class="Bound">A</a>
<a id="3366" class="Keyword">open</a> <a id="3371" href="V2.TypeChecker.html#3295" class="Module">TCExp</a>

<a id="checkExp"></a><a id="3378" href="V2.TypeChecker.html#3378" class="Function">checkExp</a> <a id="3387" class="Symbol">:</a> <a id="3389" class="Symbol">∀{</a><a id="3391" href="V2.TypeChecker.html#3391" class="Bound">Γ</a><a id="3392" class="Symbol">}</a> <a id="3394" class="Symbol">(</a><a id="3395" href="V2.TypeChecker.html#3395" class="Bound">e</a> <a id="3397" class="Symbol">:</a> <a id="3399" href="V2.AST.html#584" class="Datatype">A.Exp</a><a id="3404" class="Symbol">)</a> <a id="3406" class="Symbol">(</a><a id="3407" href="V2.TypeChecker.html#3407" class="Bound">t</a> <a id="3409" class="Symbol">:</a> <a id="3411" href="V2.AST.html#372" class="Datatype">Type</a><a id="3415" class="Symbol">)</a> <a id="3417" class="Symbol">→</a> <a id="3419" href="V2.TypeChecker.html#3295" class="Record">TCExp</a> <a id="3425" href="V2.TypeChecker.html#3391" class="Bound">Γ</a> <a id="3427" class="Symbol">(</a><a id="3428" href="V2.WellTypedSyntax.html#505" class="Datatype">Exp</a> <a id="3432" href="V2.TypeChecker.html#3391" class="Bound">Γ</a> <a id="3434" href="V2.TypeChecker.html#3407" class="Bound">t</a><a id="3435" class="Symbol">)</a>
<a id="3437" href="V2.TypeChecker.html#3378" class="Function">checkExp</a> <a id="3446" href="V2.TypeChecker.html#3446" class="Bound">e</a> <a id="3448" href="V2.TypeChecker.html#3448" class="Bound">t</a> <a id="3450" class="Symbol">.</a><a id="3451" href="V2.TypeChecker.html#3337" class="Field">runTCExp</a> <a id="3460" href="V2.TypeChecker.html#3460" class="Bound">γ</a> <a id="3462" class="Symbol">=</a> <a id="3464" href="V2.TypeChecker.html#2171" class="Function">CheckExpressions.checkExp</a> <a id="3490" href="V2.TypeChecker.html#3460" class="Bound">γ</a> <a id="3492" href="V2.TypeChecker.html#3446" class="Bound">e</a> <a id="3494" href="V2.TypeChecker.html#3448" class="Bound">t</a>

<a id="checkStms"></a><a id="3497" href="V2.TypeChecker.html#3497" class="Function">checkStms</a> <a id="3507" class="Symbol">:</a> <a id="3509" class="Symbol">∀{</a><a id="3511" href="V2.TypeChecker.html#3511" class="Bound">Γ</a><a id="3512" class="Symbol">}</a> <a id="3514" class="Symbol">(</a><a id="3515" href="V2.TypeChecker.html#3515" class="Bound">ss</a> <a id="3518" class="Symbol">:</a> <a id="3520" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="3525" href="V2.AST.html#1154" class="Datatype">A.Stm</a><a id="3530" class="Symbol">)</a> <a id="3532" class="Symbol">→</a> <a id="3534" href="V2.TypeChecker.html#3295" class="Record">TCExp</a> <a id="3540" href="V2.TypeChecker.html#3511" class="Bound">Γ</a> <a id="3542" class="Symbol">(</a><a id="3543" href="V2.WellTypedSyntax.html#1368" class="Function">Stms</a> <a id="3548" href="V2.TypeChecker.html#3511" class="Bound">Γ</a><a id="3549" class="Symbol">)</a>
<a id="3551" href="V2.TypeChecker.html#3497" class="Function">checkStms</a> <a id="3561" href="V2.TypeChecker.html#3561" class="Bound">ss</a> <a id="3564" class="Symbol">.</a><a id="3565" href="V2.TypeChecker.html#3337" class="Field">runTCExp</a> <a id="3574" href="V2.TypeChecker.html#3574" class="Bound">γ</a> <a id="3576" class="Symbol">=</a> <a id="3578" href="V2.TypeChecker.html#2986" class="Function">CheckExpressions.checkStms</a> <a id="3605" href="V2.TypeChecker.html#3574" class="Bound">γ</a> <a id="3607" href="V2.TypeChecker.html#3561" class="Bound">ss</a>

<a id="3611" class="Comment">-- Checking declarations.</a>
<a id="3637" class="Comment">---------------------------------------------------------------------------</a>

<a id="3714" class="Comment">-- Monad for checking declarations.</a>

<a id="3751" class="Comment">-- Variable declarations can be inserted into the top block, thus,</a>
<a id="3818" class="Comment">-- we need to treat the top block as mutable state.</a>

<a id="3871" class="Keyword">record</a> <a id="TCDecl"></a><a id="3878" href="V2.TypeChecker.html#3878" class="Record">TCDecl</a> <a id="3885" href="V2.TypeChecker.html#3885" class="Bound">Γ</a> <a id="3887" href="V2.TypeChecker.html#3887" class="Bound">Γ&#39;</a> <a id="3890" class="Symbol">(</a><a id="3891" href="V2.TypeChecker.html#3891" class="Bound">A</a> <a id="3893" class="Symbol">:</a> <a id="3895" class="PrimitiveType">Set</a><a id="3898" class="Symbol">)</a> <a id="3900" class="Symbol">:</a> <a id="3902" class="PrimitiveType">Set</a> <a id="3906" class="Keyword">where</a>
  <a id="3914" class="Keyword">field</a>
    <a id="TCDecl.runTCDecl"></a><a id="3924" href="V2.TypeChecker.html#3924" class="Field">runTCDecl</a> <a id="3934" class="Symbol">:</a> <a id="3936" href="V2.TypeChecker.html#364" class="Function">TCCxt</a> <a id="3942" href="V2.TypeChecker.html#3885" class="Bound">Γ</a> <a id="3944" class="Symbol">→</a> <a id="3946" href="Library.Error.html#170" class="Function">Error</a> <a id="3952" class="Symbol">(</a><a id="3953" href="V2.TypeChecker.html#3891" class="Bound">A</a> <a id="3955" href="Data.Product.html#1162" class="Function Operator">×</a> <a id="3957" href="V2.TypeChecker.html#364" class="Function">TCCxt</a> <a id="3963" href="V2.TypeChecker.html#3887" class="Bound">Γ&#39;</a><a id="3965" class="Symbol">)</a>
<a id="3967" class="Keyword">open</a> <a id="3972" href="V2.TypeChecker.html#3878" class="Module">TCDecl</a>

<a id="3980" class="Keyword">module</a> <a id="CheckDeclarations"></a><a id="3987" href="V2.TypeChecker.html#3987" class="Module">CheckDeclarations</a> <a id="4005" class="Keyword">where</a>

  <a id="4014" class="Comment">-- TCDecl is a monad.</a>

  <a id="4039" class="Keyword">private</a>

    <a id="CheckDeclarations.returnTCDecl"></a><a id="4052" href="V2.TypeChecker.html#4052" class="Function">returnTCDecl</a> <a id="4065" class="Symbol">:</a> <a id="4067" class="Symbol">∀</a> <a id="4069" class="Symbol">{</a><a id="4070" href="V2.TypeChecker.html#4070" class="Bound">Γ</a> <a id="4072" href="V2.TypeChecker.html#4072" class="Bound">A</a><a id="4073" class="Symbol">}</a> <a id="4075" class="Symbol">(</a><a id="4076" href="V2.TypeChecker.html#4076" class="Bound">a</a> <a id="4078" class="Symbol">:</a> <a id="4080" href="V2.TypeChecker.html#4072" class="Bound">A</a><a id="4081" class="Symbol">)</a> <a id="4083" class="Symbol">→</a> <a id="4085" href="V2.TypeChecker.html#3878" class="Record">TCDecl</a> <a id="4092" href="V2.TypeChecker.html#4070" class="Bound">Γ</a> <a id="4094" href="V2.TypeChecker.html#4070" class="Bound">Γ</a> <a id="4096" href="V2.TypeChecker.html#4072" class="Bound">A</a>
    <a id="4102" href="V2.TypeChecker.html#4052" class="Function">returnTCDecl</a> <a id="4115" href="V2.TypeChecker.html#4115" class="Bound">a</a> <a id="4117" class="Symbol">.</a><a id="4118" href="V2.TypeChecker.html#3924" class="Field">runTCDecl</a> <a id="4128" href="V2.TypeChecker.html#4128" class="Bound">γ</a> <a id="4130" class="Symbol">=</a> <a id="4132" href="Library.Error.html#268" class="InductiveConstructor">ok</a> <a id="4135" class="Symbol">(</a><a id="4136" href="V2.TypeChecker.html#4115" class="Bound">a</a> <a id="4138" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="4140" href="V2.TypeChecker.html#4128" class="Bound">γ</a><a id="4141" class="Symbol">)</a>

    <a id="CheckDeclarations.bindTCDecl"></a><a id="4148" href="V2.TypeChecker.html#4148" class="Function">bindTCDecl</a> <a id="4159" class="Symbol">:</a> <a id="4161" class="Symbol">∀{</a><a id="4163" href="V2.TypeChecker.html#4163" class="Bound">Γ</a> <a id="4165" href="V2.TypeChecker.html#4165" class="Bound">Γ′</a> <a id="4168" href="V2.TypeChecker.html#4168" class="Bound">Γ″</a> <a id="4171" href="V2.TypeChecker.html#4171" class="Bound">A</a> <a id="4173" href="V2.TypeChecker.html#4173" class="Bound">B</a><a id="4174" class="Symbol">}</a>
      <a id="4182" class="Symbol">(</a><a id="4183" href="V2.TypeChecker.html#4183" class="Bound">m</a> <a id="4185" class="Symbol">:</a>     <a id="4191" href="V2.TypeChecker.html#3878" class="Record">TCDecl</a> <a id="4198" href="V2.TypeChecker.html#4163" class="Bound">Γ</a>  <a id="4201" href="V2.TypeChecker.html#4165" class="Bound">Γ′</a> <a id="4204" href="V2.TypeChecker.html#4171" class="Bound">A</a><a id="4205" class="Symbol">)</a>
      <a id="4213" class="Symbol">(</a><a id="4214" href="V2.TypeChecker.html#4214" class="Bound">k</a> <a id="4216" class="Symbol">:</a> <a id="4218" href="V2.TypeChecker.html#4171" class="Bound">A</a> <a id="4220" class="Symbol">→</a> <a id="4222" href="V2.TypeChecker.html#3878" class="Record">TCDecl</a> <a id="4229" href="V2.TypeChecker.html#4165" class="Bound">Γ′</a> <a id="4232" href="V2.TypeChecker.html#4168" class="Bound">Γ″</a> <a id="4235" href="V2.TypeChecker.html#4173" class="Bound">B</a><a id="4236" class="Symbol">)</a>
             <a id="4251" class="Symbol">→</a> <a id="4253" href="V2.TypeChecker.html#3878" class="Record">TCDecl</a> <a id="4260" href="V2.TypeChecker.html#4163" class="Bound">Γ</a>  <a id="4263" href="V2.TypeChecker.html#4168" class="Bound">Γ″</a> <a id="4266" href="V2.TypeChecker.html#4173" class="Bound">B</a>

    <a id="4273" href="V2.TypeChecker.html#4148" class="Function">bindTCDecl</a> <a id="4284" href="V2.TypeChecker.html#4284" class="Bound">m</a> <a id="4286" href="V2.TypeChecker.html#4286" class="Bound">k</a> <a id="4288" class="Symbol">.</a><a id="4289" href="V2.TypeChecker.html#3924" class="Field">runTCDecl</a> <a id="4299" href="V2.TypeChecker.html#4299" class="Bound">γ</a> <a id="4301" class="Symbol">=</a>
      <a id="4309" href="Function.html#3662" class="Function Operator">case</a> <a id="4314" href="V2.TypeChecker.html#4284" class="Bound">m</a> <a id="4316" class="Symbol">.</a><a id="4317" href="V2.TypeChecker.html#3924" class="Field">runTCDecl</a> <a id="4327" href="V2.TypeChecker.html#4299" class="Bound">γ</a> <a id="4329" href="Function.html#3662" class="Function Operator">of</a> <a id="4332" class="Symbol">λ</a> <a id="4334" class="Keyword">where</a>
        <a id="4348" class="Symbol">(</a><a id="4349" href="Library.Error.html#238" class="InductiveConstructor">fail</a> <a id="4354" href="V2.TypeChecker.html#4354" class="Bound">err</a><a id="4357" class="Symbol">)</a>    <a id="4362" class="Symbol">→</a> <a id="4364" href="Library.Error.html#238" class="InductiveConstructor">fail</a> <a id="4369" href="V2.TypeChecker.html#4354" class="Bound">err</a>
        <a id="4381" class="Symbol">(</a><a id="4382" href="Library.Error.html#268" class="InductiveConstructor">ok</a> <a id="4385" class="Symbol">(</a><a id="4386" href="V2.TypeChecker.html#4386" class="Bound">a</a> <a id="4388" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="4390" href="V2.TypeChecker.html#4390" class="Bound">γ&#39;</a><a id="4392" class="Symbol">))</a> <a id="4395" class="Symbol">→</a> <a id="4397" href="V2.TypeChecker.html#4286" class="Bound">k</a> <a id="4399" href="V2.TypeChecker.html#4386" class="Bound">a</a> <a id="4401" class="Symbol">.</a><a id="4402" href="V2.TypeChecker.html#3924" class="Field">runTCDecl</a> <a id="4412" href="V2.TypeChecker.html#4390" class="Bound">γ&#39;</a>


  <a id="4419" class="Keyword">instance</a>
    <a id="CheckDeclarations.functorTCDecl"></a><a id="4432" href="V2.TypeChecker.html#4432" class="Function">functorTCDecl</a> <a id="4446" class="Symbol">:</a> <a id="4448" class="Symbol">∀</a> <a id="4450" class="Symbol">{</a><a id="4451" href="V2.TypeChecker.html#4451" class="Bound">Γ</a> <a id="4453" href="V2.TypeChecker.html#4453" class="Bound">Γ′</a><a id="4455" class="Symbol">}</a> <a id="4457" class="Symbol">→</a> <a id="4459" href="Library.Monad.html#157" class="Record">Functor</a> <a id="4467" class="Symbol">(</a><a id="4468" href="V2.TypeChecker.html#3878" class="Record">TCDecl</a> <a id="4475" href="V2.TypeChecker.html#4451" class="Bound">Γ</a> <a id="4477" href="V2.TypeChecker.html#4453" class="Bound">Γ′</a><a id="4479" class="Symbol">)</a>
    <a id="4485" href="Library.Monad.html#245" class="Field">fmap</a> <a id="4490" class="Symbol">{{</a><a id="4492" href="V2.TypeChecker.html#4432" class="Function">functorTCDecl</a><a id="4505" class="Symbol">}}</a> <a id="4508" href="V2.TypeChecker.html#4508" class="Bound">f</a> <a id="4510" href="V2.TypeChecker.html#4510" class="Bound">m</a> <a id="4512" class="Symbol">=</a> <a id="4514" href="V2.TypeChecker.html#4148" class="Function">bindTCDecl</a> <a id="4525" href="V2.TypeChecker.html#4510" class="Bound">m</a> <a id="4527" class="Symbol">(</a><a id="4528" href="V2.TypeChecker.html#4052" class="Function">returnTCDecl</a> <a id="4541" href="Function.html#3311" class="Function Operator">∘′</a> <a id="4544" href="V2.TypeChecker.html#4508" class="Bound">f</a><a id="4545" class="Symbol">)</a>

    <a id="CheckDeclarations.iApplicativeTCDecl"></a><a id="4552" href="V2.TypeChecker.html#4552" class="Function">iApplicativeTCDecl</a> <a id="4571" class="Symbol">:</a> <a id="4573" href="Library.Monad.html#368" class="Record">IApplicative</a> <a id="4586" href="V2.TypeChecker.html#3878" class="Record">TCDecl</a>
    <a id="4597" href="Library.Monad.html#487" class="Field">pure</a>  <a id="4603" class="Symbol">{{</a><a id="4605" href="V2.TypeChecker.html#4552" class="Function">iApplicativeTCDecl</a><a id="4623" class="Symbol">}}</a>       <a id="4632" class="Symbol">=</a> <a id="4634" href="V2.TypeChecker.html#4052" class="Function">returnTCDecl</a>
    <a id="4651" href="Library.Monad.html#521" class="Field Operator">_&lt;*&gt;_</a> <a id="4657" class="Symbol">{{</a><a id="4659" href="V2.TypeChecker.html#4552" class="Function">iApplicativeTCDecl</a><a id="4677" class="Symbol">}}</a> <a id="4680" href="V2.TypeChecker.html#4680" class="Bound">mf</a> <a id="4683" href="V2.TypeChecker.html#4683" class="Bound">mx</a> <a id="4686" class="Symbol">=</a> <a id="4688" href="V2.TypeChecker.html#4148" class="Function">bindTCDecl</a> <a id="4699" href="V2.TypeChecker.html#4680" class="Bound">mf</a> <a id="4702" class="Symbol">(</a><a id="4703" href="Library.Monad.html#284" class="Function Operator">_&lt;$&gt;</a> <a id="4708" href="V2.TypeChecker.html#4683" class="Bound">mx</a><a id="4710" class="Symbol">)</a>

    <a id="CheckDeclarations.iMonadTCDecl"></a><a id="4717" href="V2.TypeChecker.html#4717" class="Function">iMonadTCDecl</a> <a id="4730" class="Symbol">:</a> <a id="4732" href="Library.Monad.html#867" class="Record">IMonad</a> <a id="4739" href="V2.TypeChecker.html#3878" class="Record">TCDecl</a>
    <a id="4750" href="Library.Monad.html#1002" class="Field Operator">_&gt;&gt;=_</a> <a id="4756" class="Symbol">{{</a><a id="4758" href="V2.TypeChecker.html#4717" class="Function">iMonadTCDecl</a><a id="4770" class="Symbol">}}</a> <a id="4773" class="Symbol">=</a> <a id="4775" href="V2.TypeChecker.html#4148" class="Function">bindTCDecl</a>

  <a id="4789" class="Comment">-- Lifting a TCExp computation into TCDecl.</a>

  <a id="CheckDeclarations.lift"></a><a id="4836" href="V2.TypeChecker.html#4836" class="Function">lift</a> <a id="4841" class="Symbol">:</a> <a id="4843" class="Symbol">∀{</a><a id="4845" href="V2.TypeChecker.html#4845" class="Bound">Γ</a> <a id="4847" href="V2.TypeChecker.html#4847" class="Bound">A</a><a id="4848" class="Symbol">}</a> <a id="4850" class="Symbol">(</a><a id="4851" href="V2.TypeChecker.html#4851" class="Bound">m</a> <a id="4853" class="Symbol">:</a> <a id="4855" href="V2.TypeChecker.html#3295" class="Record">TCExp</a> <a id="4861" href="V2.TypeChecker.html#4845" class="Bound">Γ</a> <a id="4863" href="V2.TypeChecker.html#4847" class="Bound">A</a><a id="4864" class="Symbol">)</a> <a id="4866" class="Symbol">→</a> <a id="4868" href="V2.TypeChecker.html#3878" class="Record">TCDecl</a> <a id="4875" href="V2.TypeChecker.html#4845" class="Bound">Γ</a> <a id="4877" href="V2.TypeChecker.html#4845" class="Bound">Γ</a> <a id="4879" href="V2.TypeChecker.html#4847" class="Bound">A</a>
  <a id="4883" href="V2.TypeChecker.html#4836" class="Function">lift</a> <a id="4888" href="V2.TypeChecker.html#4888" class="Bound">m</a> <a id="4890" class="Symbol">.</a><a id="4891" href="V2.TypeChecker.html#3924" class="Field">runTCDecl</a> <a id="4901" href="V2.TypeChecker.html#4901" class="Bound">γ</a> <a id="4903" class="Symbol">=</a>
    <a id="4909" href="Function.html#3662" class="Function Operator">case</a> <a id="4914" href="V2.TypeChecker.html#4888" class="Bound">m</a> <a id="4916" class="Symbol">.</a><a id="4917" href="V2.TypeChecker.html#3337" class="Field">runTCExp</a> <a id="4926" href="V2.TypeChecker.html#4901" class="Bound">γ</a> <a id="4928" href="Function.html#3662" class="Function Operator">of</a> <a id="4931" class="Symbol">λ</a> <a id="4933" class="Keyword">where</a>
      <a id="4945" class="Symbol">(</a><a id="4946" href="Library.Error.html#238" class="InductiveConstructor">fail</a> <a id="4951" href="V2.TypeChecker.html#4951" class="Bound">err</a><a id="4954" class="Symbol">)</a> <a id="4956" class="Symbol">→</a> <a id="4958" href="Library.Error.html#238" class="InductiveConstructor">fail</a> <a id="4963" href="V2.TypeChecker.html#4951" class="Bound">err</a>
      <a id="4973" class="Symbol">(</a><a id="4974" href="Library.Error.html#268" class="InductiveConstructor">ok</a> <a id="4977" href="V2.TypeChecker.html#4977" class="Bound">a</a><a id="4978" class="Symbol">)</a>     <a id="4984" class="Symbol">→</a> <a id="4986" href="Library.Error.html#268" class="InductiveConstructor">ok</a> <a id="4989" class="Symbol">(</a><a id="4990" href="V2.TypeChecker.html#4977" class="Bound">a</a> <a id="4992" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="4994" href="V2.TypeChecker.html#4901" class="Bound">γ</a><a id="4995" class="Symbol">)</a>

  <a id="5000" class="Comment">-- Add a variable declaration.</a>

  <a id="CheckDeclarations.addVar"></a><a id="5034" href="V2.TypeChecker.html#5034" class="Function">addVar</a> <a id="5041" class="Symbol">:</a> <a id="5043" class="Symbol">∀{</a><a id="5045" href="V2.TypeChecker.html#5045" class="Bound">Γ</a><a id="5046" class="Symbol">}</a> <a id="5048" class="Symbol">(</a><a id="5049" href="V2.TypeChecker.html#5049" class="Bound">x</a> <a id="5051" class="Symbol">:</a> <a id="5053" href="V2.TypeChecker.html#245" class="Function">Name</a><a id="5057" class="Symbol">)</a> <a id="5059" href="V2.TypeChecker.html#5059" class="Bound">t</a> <a id="5061" class="Symbol">→</a> <a id="5063" href="V2.TypeChecker.html#3878" class="Record">TCDecl</a> <a id="5070" href="V2.TypeChecker.html#5045" class="Bound">Γ</a> <a id="5072" class="Symbol">(</a><a id="5073" href="V2.TypeChecker.html#5059" class="Bound">t</a> <a id="5075" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="5077" href="V2.TypeChecker.html#5045" class="Bound">Γ</a><a id="5078" class="Symbol">)</a> <a id="5080" href="Agda.Builtin.Unit.html#137" class="Record">⊤</a>
  <a id="5084" href="V2.TypeChecker.html#5034" class="Function">addVar</a> <a id="5091" class="Symbol">{</a><a id="5092" class="Argument">Γ</a> <a id="5094" class="Symbol">=</a> <a id="5096" href="V2.TypeChecker.html#5096" class="Bound">Γ</a><a id="5097" class="Symbol">}</a> <a id="5099" href="V2.TypeChecker.html#5099" class="Bound">x</a> <a id="5101" href="V2.TypeChecker.html#5101" class="Bound">t</a> <a id="5103" class="Symbol">.</a><a id="5104" href="V2.TypeChecker.html#3924" class="Field">runTCDecl</a> <a id="5114" href="V2.TypeChecker.html#5114" class="Bound">γ</a> <a id="5116" class="Symbol">=</a> <a id="5118" href="Library.Error.html#268" class="InductiveConstructor">ok</a> <a id="5121" class="Symbol">(_</a> <a id="5124" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="5126" class="Symbol">(</a><a id="5127" href="V2.TypeChecker.html#5101" class="Bound">t</a> <a id="5129" href="Library.List.html#1527" class="Function Operator">↦</a> <a id="5131" href="V2.TypeChecker.html#5099" class="Bound">x</a> <a id="5133" href="Library.List.html#1527" class="Function Operator">∷</a> <a id="5135" href="V2.TypeChecker.html#5114" class="Bound">γ</a><a id="5136" class="Symbol">))</a>

  <a id="5142" class="Comment">-- Predicting the next shape of the context.</a>

  <a id="CheckDeclarations.Next"></a><a id="5190" href="V2.TypeChecker.html#5190" class="Function">Next</a> <a id="5195" class="Symbol">:</a> <a id="5197" class="Symbol">(</a><a id="5198" href="V2.TypeChecker.html#5198" class="Bound">Γ</a> <a id="5200" class="Symbol">:</a> <a id="5202" href="V2.WellTypedSyntax.html#255" class="Function">Cxt</a><a id="5205" class="Symbol">)</a> <a id="5207" class="Symbol">(</a><a id="5208" href="V2.TypeChecker.html#5208" class="Bound">s</a> <a id="5210" class="Symbol">:</a> <a id="5212" href="V2.AST.html#973" class="Record">A.Decl</a><a id="5218" class="Symbol">)</a> <a id="5220" class="Symbol">→</a> <a id="5222" href="V2.WellTypedSyntax.html#255" class="Function">Cxt</a>
  <a id="5228" href="V2.TypeChecker.html#5190" class="Function">Next</a> <a id="5233" href="V2.TypeChecker.html#5233" class="Bound">Γ</a> <a id="5235" href="V2.TypeChecker.html#5235" class="Bound">s</a> <a id="5237" class="Symbol">=</a> <a id="5239" href="V2.AST.html#1018" class="Field">A.declType</a> <a id="5250" href="V2.TypeChecker.html#5235" class="Bound">s</a> <a id="5252" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="5254" href="V2.TypeChecker.html#5233" class="Bound">Γ</a>

  <a id="CheckDeclarations.Nexts"></a><a id="5259" href="V2.TypeChecker.html#5259" class="Function">Nexts</a> <a id="5265" class="Symbol">:</a> <a id="5267" class="Symbol">(</a><a id="5268" href="V2.TypeChecker.html#5268" class="Bound">Γ</a> <a id="5270" class="Symbol">:</a> <a id="5272" href="V2.WellTypedSyntax.html#255" class="Function">Cxt</a><a id="5275" class="Symbol">)</a> <a id="5277" class="Symbol">(</a><a id="5278" href="V2.TypeChecker.html#5278" class="Bound">ss</a> <a id="5281" class="Symbol">:</a> <a id="5283" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="5288" href="V2.AST.html#973" class="Record">A.Decl</a><a id="5294" class="Symbol">)</a> <a id="5296" class="Symbol">→</a> <a id="5298" href="V2.WellTypedSyntax.html#255" class="Function">Cxt</a>
  <a id="5304" href="V2.TypeChecker.html#5259" class="Function">Nexts</a> <a id="5310" class="Symbol">=</a> <a id="5312" href="Data.List.Base.html#3533" class="Function">foldl</a> <a id="5318" href="V2.TypeChecker.html#5190" class="Function">Next</a>

  <a id="5326" class="Keyword">mutual</a>

    <a id="5338" class="Comment">-- Checking a single declaration.</a>

    <a id="CheckDeclarations.checkDecl"></a><a id="5377" href="V2.TypeChecker.html#5377" class="Function">checkDecl</a> <a id="5387" class="Symbol">:</a> <a id="5389" class="Symbol">∀</a> <a id="5391" class="Symbol">{</a><a id="5392" href="V2.TypeChecker.html#5392" class="Bound">Γ</a><a id="5393" class="Symbol">}</a> <a id="5395" class="Symbol">(</a><a id="5396" href="V2.TypeChecker.html#5396" class="Bound">d</a> <a id="5398" class="Symbol">:</a> <a id="5400" href="V2.AST.html#973" class="Record">A.Decl</a><a id="5406" class="Symbol">)</a> <a id="5408" class="Symbol">(</a><a id="5409" class="Keyword">let</a> <a id="5413" href="V2.TypeChecker.html#5413" class="Bound">t</a> <a id="5415" class="Symbol">=</a> <a id="5417" href="V2.AST.html#1018" class="Field">A.declType</a> <a id="5428" href="V2.TypeChecker.html#5396" class="Bound">d</a><a id="5429" class="Symbol">)</a>
      <a id="5437" class="Symbol">→</a> <a id="5439" href="V2.TypeChecker.html#3878" class="Record">TCDecl</a> <a id="5446" href="V2.TypeChecker.html#5392" class="Bound">Γ</a> <a id="5448" class="Symbol">(</a><a id="5449" href="V2.TypeChecker.html#5413" class="Bound">t</a> <a id="5451" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="5453" href="V2.TypeChecker.html#5392" class="Bound">Γ</a><a id="5454" class="Symbol">)</a> <a id="5456" class="Symbol">(</a><a id="5457" href="V2.WellTypedSyntax.html#890" class="Datatype">Decl</a> <a id="5462" href="V2.TypeChecker.html#5392" class="Bound">Γ</a> <a id="5464" href="V2.TypeChecker.html#5413" class="Bound">t</a><a id="5465" class="Symbol">)</a>

    <a id="5472" href="V2.TypeChecker.html#5377" class="Function">checkDecl</a> <a id="5482" class="Symbol">(</a><a id="5483" href="V2.AST.html#1004" class="InductiveConstructor">A.dInit</a> <a id="5491" href="V2.TypeChecker.html#5491" class="Bound">t</a> <a id="5493" href="V2.TypeChecker.html#5493" class="Bound">x</a> <a id="5495" href="V2.TypeChecker.html#5495" class="Bound">e</a><a id="5496" class="Symbol">)</a> <a id="5498" class="Symbol">=</a> <a id="5500" class="Keyword">do</a>
      <a id="5509" href="V2.TypeChecker.html#5509" class="Bound">e&#39;</a> <a id="5512" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="5514" href="V2.TypeChecker.html#4836" class="Function">lift</a> <a id="5519" href="Function.html#1645" class="Function Operator">$</a> <a id="5521" href="V2.TypeChecker.html#3378" class="Function">checkExp</a> <a id="5530" href="V2.TypeChecker.html#5495" class="Bound">e</a> <a id="5532" href="V2.TypeChecker.html#5491" class="Bound">t</a>
      <a id="5540" href="V2.TypeChecker.html#5034" class="Function">addVar</a> <a id="5547" class="Symbol">(</a><a id="5548" href="V2.TypeChecker.html#260" class="Function">idToName</a> <a id="5557" href="V2.TypeChecker.html#5493" class="Bound">x</a><a id="5558" class="Symbol">)</a> <a id="5560" href="V2.TypeChecker.html#5491" class="Bound">t</a>
      <a id="5568" href="Library.Monad.html#1110" class="Function">return</a> <a id="5575" class="Symbol">(</a><a id="5576" href="V2.WellTypedSyntax.html#930" class="InductiveConstructor">dInit</a> <a id="5582" href="V2.TypeChecker.html#5509" class="Bound">e&#39;</a><a id="5584" class="Symbol">)</a>

    <a id="5591" class="Comment">-- Checking a list of declarations.</a>

    <a id="CheckDeclarations.checkDecls"></a><a id="5632" href="V2.TypeChecker.html#5632" class="Function">checkDecls</a> <a id="5643" class="Symbol">:</a> <a id="5645" class="Symbol">∀</a> <a id="5647" class="Symbol">{</a><a id="5648" href="V2.TypeChecker.html#5648" class="Bound">Γ</a><a id="5649" class="Symbol">}</a> <a id="5651" class="Symbol">(</a><a id="5652" href="V2.TypeChecker.html#5652" class="Bound">ds</a> <a id="5655" class="Symbol">:</a> <a id="5657" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="5662" href="V2.AST.html#973" class="Record">A.Decl</a><a id="5668" class="Symbol">)</a> <a id="5670" class="Symbol">(</a><a id="5671" class="Keyword">let</a> <a id="5675" href="V2.TypeChecker.html#5675" class="Bound">Γ&#39;</a> <a id="5678" class="Symbol">=</a> <a id="5680" href="V2.TypeChecker.html#5259" class="Function">Nexts</a> <a id="5686" href="V2.TypeChecker.html#5648" class="Bound">Γ</a> <a id="5688" href="V2.TypeChecker.html#5652" class="Bound">ds</a><a id="5690" class="Symbol">)</a>
      <a id="5698" class="Symbol">→</a> <a id="5700" href="V2.TypeChecker.html#3878" class="Record">TCDecl</a> <a id="5707" href="V2.TypeChecker.html#5648" class="Bound">Γ</a> <a id="5709" href="V2.TypeChecker.html#5675" class="Bound">Γ&#39;</a> <a id="5712" class="Symbol">(</a><a id="5713" href="V2.WellTypedSyntax.html#969" class="Datatype">Decls</a> <a id="5719" href="V2.TypeChecker.html#5648" class="Bound">Γ</a> <a id="5721" href="V2.TypeChecker.html#5675" class="Bound">Γ&#39;</a><a id="5723" class="Symbol">)</a>

    <a id="5730" href="V2.TypeChecker.html#5632" class="Function">checkDecls</a> <a id="5741" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>       <a id="5750" class="Symbol">=</a> <a id="5752" href="Library.Monad.html#1110" class="Function">return</a> <a id="5759" href="V2.WellTypedSyntax.html#1005" class="InductiveConstructor">[]</a>
    <a id="5766" href="V2.TypeChecker.html#5632" class="Function">checkDecls</a> <a id="5777" class="Symbol">(</a><a id="5778" href="V2.TypeChecker.html#5778" class="Bound">d</a> <a id="5780" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="5782" href="V2.TypeChecker.html#5782" class="Bound">ds</a><a id="5784" class="Symbol">)</a> <a id="5786" class="Symbol">=</a> <a id="5788" class="Keyword">do</a>
      <a id="5797" href="V2.TypeChecker.html#5797" class="Bound">d&#39;</a> <a id="5800" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="5802" href="V2.TypeChecker.html#5377" class="Function">checkDecl</a> <a id="5812" href="V2.TypeChecker.html#5778" class="Bound">d</a>
      <a id="5820" class="Symbol">(</a><a id="5821" href="V2.TypeChecker.html#5797" class="Bound">d&#39;</a> <a id="5824" href="V2.WellTypedSyntax.html#1023" class="InductiveConstructor Operator">∷_</a><a id="5826" class="Symbol">)</a> <a id="5828" href="Library.Monad.html#284" class="Function Operator">&lt;$&gt;</a> <a id="5832" href="V2.TypeChecker.html#5632" class="Function">checkDecls</a> <a id="5843" href="V2.TypeChecker.html#5782" class="Bound">ds</a>

  <a id="5849" class="Comment">-- Checking the program in TCDecl.</a>

  <a id="CheckDeclarations.checkProgram"></a><a id="5887" href="V2.TypeChecker.html#5887" class="Function">checkProgram</a> <a id="5900" class="Symbol">:</a> <a id="5902" class="Symbol">(</a><a id="5903" href="V2.TypeChecker.html#5903" class="Bound">prg</a> <a id="5907" class="Symbol">:</a> <a id="5909" href="V2.AST.html#1334" class="Record">A.Program</a><a id="5918" class="Symbol">)</a> <a id="5920" class="Symbol">(</a><a id="5921" class="Keyword">let</a> <a id="5925" href="V2.TypeChecker.html#5925" class="Bound">Γ</a> <a id="5927" class="Symbol">=</a> <a id="5929" href="V2.TypeChecker.html#5259" class="Function">Nexts</a> <a id="5935" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="5938" class="Symbol">(</a><a id="5939" href="V2.AST.html#1388" class="Field">A.theDecls</a> <a id="5950" href="V2.TypeChecker.html#5903" class="Bound">prg</a><a id="5953" class="Symbol">))</a>
    <a id="5960" class="Symbol">→</a> <a id="5962" href="V2.TypeChecker.html#3878" class="Record">TCDecl</a> <a id="5969" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="5972" href="V2.TypeChecker.html#5925" class="Bound">Γ</a> <a id="5974" href="V2.WellTypedSyntax.html#1479" class="Record">Program</a>

  <a id="5985" href="V2.TypeChecker.html#5887" class="Function">checkProgram</a> <a id="5998" class="Symbol">(</a><a id="5999" href="V2.AST.html#1368" class="InductiveConstructor">A.program</a> <a id="6009" href="V2.TypeChecker.html#6009" class="Bound">ds</a> <a id="6012" href="V2.TypeChecker.html#6012" class="Bound">ss</a> <a id="6015" href="V2.TypeChecker.html#6015" class="Bound">e</a><a id="6016" class="Symbol">)</a> <a id="6018" class="Symbol">=</a> <a id="6020" class="Keyword">do</a>
    <a id="6027" href="V2.TypeChecker.html#6027" class="Bound">ds&#39;</a> <a id="6031" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="6033" href="V2.TypeChecker.html#5632" class="Function">checkDecls</a> <a id="6044" href="V2.TypeChecker.html#6009" class="Bound">ds</a>
    <a id="6051" href="V2.TypeChecker.html#6051" class="Bound">ss&#39;</a> <a id="6055" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="6057" href="V2.TypeChecker.html#4836" class="Function">lift</a> <a id="6062" href="Function.html#1645" class="Function Operator">$</a> <a id="6064" href="V2.TypeChecker.html#3497" class="Function">checkStms</a> <a id="6074" href="V2.TypeChecker.html#6012" class="Bound">ss</a>
    <a id="6081" href="V2.TypeChecker.html#6081" class="Bound">e&#39;</a>  <a id="6085" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="6087" href="V2.TypeChecker.html#4836" class="Function">lift</a> <a id="6092" href="Function.html#1645" class="Function Operator">$</a> <a id="6094" href="V2.TypeChecker.html#3378" class="Function">checkExp</a> <a id="6103" href="V2.TypeChecker.html#6015" class="Bound">e</a> <a id="6105" href="V2.AST.html#396" class="InductiveConstructor">int</a>
    <a id="6113" href="Library.Monad.html#1110" class="Function">return</a> <a id="6120" class="Symbol">(</a><a id="6121" href="V2.WellTypedSyntax.html#1513" class="InductiveConstructor">program</a> <a id="6129" href="V2.TypeChecker.html#6027" class="Bound">ds&#39;</a> <a id="6133" href="V2.TypeChecker.html#6051" class="Bound">ss&#39;</a> <a id="6137" href="V2.TypeChecker.html#6081" class="Bound">e&#39;</a><a id="6139" class="Symbol">)</a>

<a id="6142" class="Comment">-- Checking the program.</a>
<a id="6167" class="Comment">---------------------------------------------------------------------------</a>

<a id="checkProgram"></a><a id="6244" href="V2.TypeChecker.html#6244" class="Function">checkProgram</a> <a id="6257" class="Symbol">:</a> <a id="6259" class="Symbol">(</a><a id="6260" href="V2.TypeChecker.html#6260" class="Bound">prg</a> <a id="6264" class="Symbol">:</a> <a id="6266" href="V2.AST.html#1334" class="Record">A.Program</a><a id="6275" class="Symbol">)</a> <a id="6277" class="Symbol">→</a> <a id="6279" href="Library.Error.html#170" class="Function">Error</a> <a id="6285" href="V2.WellTypedSyntax.html#1479" class="Record">Program</a>
<a id="6293" href="V2.TypeChecker.html#6244" class="Function">checkProgram</a> <a id="6306" href="V2.TypeChecker.html#6306" class="Bound">prg</a> <a id="6310" class="Symbol">=</a> <a id="6312" href="Agda.Builtin.Sigma.html#225" class="Field">proj₁</a> <a id="6318" href="Library.Monad.html#284" class="Function Operator">&lt;$&gt;</a> <a id="6322" href="V2.TypeChecker.html#5887" class="Function">CheckDeclarations.checkProgram</a> <a id="6353" href="V2.TypeChecker.html#6306" class="Bound">prg</a> <a id="6357" class="Symbol">.</a><a id="6358" href="V2.TypeChecker.html#3924" class="Field">runTCDecl</a> <a id="6368" href="Data.List.Relation.Unary.All.html#1239" class="InductiveConstructor">[]</a>


<a id="6373" class="Comment">-- -}</a>
<a id="6379" class="Comment">-- -}</a>
<a id="6385" class="Comment">-- -}</a>
<a id="6391" class="Comment">-- -}</a>
<a id="6397" class="Comment">-- -}</a>
<a id="6403" class="Comment">-- -}</a>
</pre></body></html>
