<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>V3.UntypedInterpreter</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">-- Untyped interpreter for the WHILE language.</a>
<a id="48" class="Comment">--</a>
<a id="51" class="Comment">-- * Runs directly on the unchecked abstract syntax tree.</a>
<a id="109" class="Comment">-- * May fail due to scope and other runtime errors.</a>
<a id="162" class="Comment">-- * while loops may not terminate.</a>

<a id="199" class="Keyword">module</a> <a id="206" href="V3.UntypedInterpreter.html" class="Module">V3.UntypedInterpreter</a> <a id="228" class="Keyword">where</a>

<a id="235" class="Keyword">open</a> <a id="240" class="Keyword">import</a> <a id="247" href="Library.html" class="Module">Library</a>
<a id="255" class="Keyword">open</a> <a id="260" class="Keyword">import</a> <a id="267" href="V3.AST.html" class="Module">V3.AST</a>

<a id="275" class="Comment">-- Untyped values.</a>

<a id="295" class="Keyword">data</a> <a id="Val"></a><a id="300" href="V3.UntypedInterpreter.html#300" class="Datatype">Val</a> <a id="304" class="Symbol">:</a> <a id="306" class="PrimitiveType">Set</a> <a id="310" class="Keyword">where</a>
  <a id="Val.intV"></a><a id="318" href="V3.UntypedInterpreter.html#318" class="InductiveConstructor">intV</a>  <a id="324" class="Symbol">:</a> <a id="326" href="Agda.Builtin.Int.html#219" class="Datatype">ℤ</a>       <a id="334" class="Symbol">→</a> <a id="336" href="V3.UntypedInterpreter.html#300" class="Datatype">Val</a>
  <a id="Val.boolV"></a><a id="342" href="V3.UntypedInterpreter.html#342" class="InductiveConstructor">boolV</a> <a id="348" class="Symbol">:</a> <a id="350" href="V3.AST.html#474" class="Datatype">Boolean</a> <a id="358" class="Symbol">→</a> <a id="360" href="V3.UntypedInterpreter.html#300" class="Datatype">Val</a>

<a id="365" class="Keyword">instance</a>
  <a id="PrintVal"></a><a id="376" href="V3.UntypedInterpreter.html#376" class="Function">PrintVal</a> <a id="385" class="Symbol">:</a> <a id="387" href="Library.Print.html#196" class="Record">Print</a> <a id="393" href="V3.UntypedInterpreter.html#300" class="Datatype">Val</a>
  <a id="399" href="Library.Print.html#244" class="Field">print</a> <a id="405" class="Symbol">{{</a><a id="407" href="V3.UntypedInterpreter.html#376" class="Function">PrintVal</a><a id="415" class="Symbol">}}</a> <a id="418" class="Symbol">=</a> <a id="420" class="Symbol">λ</a> <a id="422" class="Keyword">where</a>
    <a id="432" class="Symbol">(</a><a id="433" href="V3.UntypedInterpreter.html#318" class="InductiveConstructor">intV</a> <a id="438" href="V3.UntypedInterpreter.html#438" class="Bound">i</a><a id="439" class="Symbol">)</a>  <a id="442" class="Symbol">→</a> <a id="444" href="Library.Print.html#244" class="Field">print</a> <a id="450" href="V3.UntypedInterpreter.html#438" class="Bound">i</a>
    <a id="456" class="Symbol">(</a><a id="457" href="V3.UntypedInterpreter.html#342" class="InductiveConstructor">boolV</a> <a id="463" href="V3.UntypedInterpreter.html#463" class="Bound">b</a><a id="464" class="Symbol">)</a> <a id="466" class="Symbol">→</a> <a id="468" href="Library.Print.html#244" class="Field">print</a> <a id="474" href="V3.UntypedInterpreter.html#463" class="Bound">b</a>

<a id="477" class="Comment">-- Poor man&#39;s environments (association list).</a>

<a id="Env"></a><a id="525" href="V3.UntypedInterpreter.html#525" class="Function">Env</a> <a id="529" class="Symbol">:</a> <a id="531" class="PrimitiveType">Set</a>
<a id="535" href="V3.UntypedInterpreter.html#525" class="Function">Env</a> <a id="539" class="Symbol">=</a> <a id="541" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="546" class="Symbol">(</a><a id="547" href="V3.AST.html#282" class="Datatype">Id</a> <a id="550" href="Data.Product.html#1162" class="Function Operator">×</a> <a id="552" href="V3.UntypedInterpreter.html#300" class="Datatype">Val</a><a id="555" class="Symbol">)</a>

<a id="558" class="Comment">-- Looking up the value bound to a variable in an environment.</a>

<a id="lookupId"></a><a id="622" href="V3.UntypedInterpreter.html#622" class="Function">lookupId</a> <a id="631" class="Symbol">:</a> <a id="633" href="V3.UntypedInterpreter.html#525" class="Function">Env</a> <a id="637" class="Symbol">→</a> <a id="639" href="V3.AST.html#282" class="Datatype">Id</a> <a id="642" class="Symbol">→</a> <a id="644" href="Data.Maybe.Base.html#795" class="Datatype">Maybe</a> <a id="650" href="V3.UntypedInterpreter.html#300" class="Datatype">Val</a>
<a id="654" href="V3.UntypedInterpreter.html#622" class="Function">lookupId</a> <a id="663" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>             <a id="678" href="V3.UntypedInterpreter.html#678" class="Bound">y</a> <a id="680" class="Symbol">=</a> <a id="682" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>
<a id="690" href="V3.UntypedInterpreter.html#622" class="Function">lookupId</a> <a id="699" class="Symbol">((</a><a id="701" href="V3.UntypedInterpreter.html#701" class="Bound">x</a> <a id="703" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="705" href="V3.UntypedInterpreter.html#705" class="Bound">v</a><a id="706" class="Symbol">)</a> <a id="708" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="710" href="V3.UntypedInterpreter.html#710" class="Bound">xs</a><a id="712" class="Symbol">)</a> <a id="714" href="V3.UntypedInterpreter.html#714" class="Bound">y</a> <a id="716" class="Symbol">=</a>
  <a id="720" href="Data.Bool.Base.html#1312" class="Function Operator">if</a> <a id="723" href="V3.UntypedInterpreter.html#701" class="Bound">x</a> <a id="725" href="Library.Eq.html#688" class="Function Operator">==</a> <a id="728" href="V3.UntypedInterpreter.html#714" class="Bound">y</a>
  <a id="732" href="Data.Bool.Base.html#1312" class="Function Operator">then</a> <a id="737" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="742" href="V3.UntypedInterpreter.html#705" class="Bound">v</a>
  <a id="746" href="Data.Bool.Base.html#1312" class="Function Operator">else</a> <a id="751" href="V3.UntypedInterpreter.html#622" class="Function">lookupId</a> <a id="760" href="V3.UntypedInterpreter.html#710" class="Bound">xs</a> <a id="763" href="V3.UntypedInterpreter.html#714" class="Bound">y</a>

<a id="766" class="Comment">-- Adding or updating a binding in the environment.</a>

<a id="updateEnv"></a><a id="819" href="V3.UntypedInterpreter.html#819" class="Function">updateEnv</a> <a id="829" class="Symbol">:</a> <a id="831" href="V3.AST.html#282" class="Datatype">Id</a> <a id="834" class="Symbol">→</a> <a id="836" href="V3.UntypedInterpreter.html#300" class="Datatype">Val</a> <a id="840" class="Symbol">→</a> <a id="842" href="V3.UntypedInterpreter.html#525" class="Function">Env</a> <a id="846" class="Symbol">→</a> <a id="848" href="V3.UntypedInterpreter.html#525" class="Function">Env</a>
<a id="852" href="V3.UntypedInterpreter.html#819" class="Function">updateEnv</a> <a id="862" href="V3.UntypedInterpreter.html#862" class="Bound">x</a> <a id="864" href="V3.UntypedInterpreter.html#864" class="Bound">v</a> <a id="866" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>            <a id="880" class="Symbol">=</a> <a id="882" class="Symbol">(</a><a id="883" href="V3.UntypedInterpreter.html#862" class="Bound">x</a> <a id="885" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="887" href="V3.UntypedInterpreter.html#864" class="Bound">v</a><a id="888" class="Symbol">)</a> <a id="890" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="892" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>
<a id="895" href="V3.UntypedInterpreter.html#819" class="Function">updateEnv</a> <a id="905" href="V3.UntypedInterpreter.html#905" class="Bound">x</a> <a id="907" href="V3.UntypedInterpreter.html#907" class="Bound">v</a> <a id="909" class="Symbol">((</a><a id="911" href="V3.UntypedInterpreter.html#911" class="Bound">y</a> <a id="913" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="915" href="V3.UntypedInterpreter.html#915" class="Bound">w</a><a id="916" class="Symbol">)</a> <a id="918" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="920" href="V3.UntypedInterpreter.html#920" class="Bound">ρ</a><a id="921" class="Symbol">)</a> <a id="923" class="Symbol">=</a>
  <a id="927" href="Data.Bool.Base.html#1312" class="Function Operator">if</a> <a id="930" href="V3.UntypedInterpreter.html#905" class="Bound">x</a> <a id="932" href="Library.Eq.html#688" class="Function Operator">==</a> <a id="935" href="V3.UntypedInterpreter.html#911" class="Bound">y</a>
  <a id="939" href="Data.Bool.Base.html#1312" class="Function Operator">then</a> <a id="944" class="Symbol">(</a><a id="945" href="V3.UntypedInterpreter.html#905" class="Bound">x</a> <a id="947" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="949" href="V3.UntypedInterpreter.html#907" class="Bound">v</a><a id="950" class="Symbol">)</a> <a id="952" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="954" href="V3.UntypedInterpreter.html#920" class="Bound">ρ</a>
  <a id="958" href="Data.Bool.Base.html#1312" class="Function Operator">else</a> <a id="963" class="Symbol">(</a><a id="964" href="V3.UntypedInterpreter.html#911" class="Bound">y</a> <a id="966" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="968" href="V3.UntypedInterpreter.html#915" class="Bound">w</a><a id="969" class="Symbol">)</a> <a id="971" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="973" href="V3.UntypedInterpreter.html#819" class="Function">updateEnv</a> <a id="983" href="V3.UntypedInterpreter.html#905" class="Bound">x</a> <a id="985" href="V3.UntypedInterpreter.html#907" class="Bound">v</a> <a id="987" href="V3.UntypedInterpreter.html#920" class="Bound">ρ</a>

<a id="990" class="Comment">-- -- Poor man&#39;s version, keeps history of bindings.</a>
<a id="1043" class="Comment">-- updateEnv x v ρ = (x , v) ∷ ρ</a>
<a id="1076" class="Comment">-- updateEnv : Id → Val → Env → Env</a>

<a id="1113" class="Comment">-- Semantics of operations.</a>

<a id="1142" class="Comment">-- Boolean negation.</a>

<a id="bNot"></a><a id="1164" href="V3.UntypedInterpreter.html#1164" class="Function">bNot</a> <a id="1169" class="Symbol">:</a> <a id="1171" href="V3.AST.html#474" class="Datatype">Boolean</a> <a id="1179" class="Symbol">→</a> <a id="1181" href="V3.AST.html#474" class="Datatype">Boolean</a>
<a id="1189" href="V3.UntypedInterpreter.html#1164" class="Function">bNot</a> <a id="1194" href="V3.AST.html#496" class="InductiveConstructor">true</a> <a id="1199" class="Symbol">=</a> <a id="1201" href="V3.AST.html#501" class="InductiveConstructor">false</a>
<a id="1207" href="V3.UntypedInterpreter.html#1164" class="Function">bNot</a> <a id="1212" href="V3.AST.html#501" class="InductiveConstructor">false</a> <a id="1218" class="Symbol">=</a> <a id="1220" href="V3.AST.html#496" class="InductiveConstructor">true</a>

<a id="1226" class="Comment">-- Boolean conjunction.</a>

<a id="bAnd"></a><a id="1251" href="V3.UntypedInterpreter.html#1251" class="Function">bAnd</a> <a id="1256" class="Symbol">:</a> <a id="1258" href="V3.AST.html#474" class="Datatype">Boolean</a> <a id="1266" class="Symbol">→</a> <a id="1268" href="V3.AST.html#474" class="Datatype">Boolean</a> <a id="1276" class="Symbol">→</a> <a id="1278" href="V3.AST.html#474" class="Datatype">Boolean</a>
<a id="1286" href="V3.UntypedInterpreter.html#1251" class="Function">bAnd</a> <a id="1291" href="V3.AST.html#496" class="InductiveConstructor">true</a>  <a id="1297" href="V3.UntypedInterpreter.html#1297" class="Bound">b</a> <a id="1299" class="Symbol">=</a> <a id="1301" href="V3.UntypedInterpreter.html#1297" class="Bound">b</a>
<a id="1303" href="V3.UntypedInterpreter.html#1251" class="Function">bAnd</a> <a id="1308" href="V3.AST.html#501" class="InductiveConstructor">false</a> <a id="1314" class="Symbol">_</a> <a id="1316" class="Symbol">=</a> <a id="1318" href="V3.AST.html#501" class="InductiveConstructor">false</a>

<a id="1325" class="Comment">-- Boolean conditional</a>

<a id="bIf"></a><a id="1349" href="V3.UntypedInterpreter.html#1349" class="Function">bIf</a> <a id="1353" class="Symbol">:</a> <a id="1355" class="Symbol">{</a><a id="1356" href="V3.UntypedInterpreter.html#1356" class="Bound">A</a> <a id="1358" class="Symbol">:</a> <a id="1360" class="PrimitiveType">Set</a><a id="1363" class="Symbol">}</a> <a id="1365" class="Symbol">→</a> <a id="1367" href="V3.AST.html#474" class="Datatype">Boolean</a> <a id="1375" class="Symbol">→</a> <a id="1377" href="V3.UntypedInterpreter.html#1356" class="Bound">A</a> <a id="1379" class="Symbol">→</a> <a id="1381" href="V3.UntypedInterpreter.html#1356" class="Bound">A</a> <a id="1383" class="Symbol">→</a> <a id="1385" href="V3.UntypedInterpreter.html#1356" class="Bound">A</a>
<a id="1387" href="V3.UntypedInterpreter.html#1349" class="Function">bIf</a> <a id="1391" href="V3.AST.html#496" class="InductiveConstructor">true</a>  <a id="1397" href="V3.UntypedInterpreter.html#1397" class="Bound">x</a> <a id="1399" href="V3.UntypedInterpreter.html#1399" class="Bound">y</a> <a id="1401" class="Symbol">=</a> <a id="1403" href="V3.UntypedInterpreter.html#1397" class="Bound">x</a>
<a id="1405" href="V3.UntypedInterpreter.html#1349" class="Function">bIf</a> <a id="1409" href="V3.AST.html#501" class="InductiveConstructor">false</a> <a id="1415" href="V3.UntypedInterpreter.html#1415" class="Bound">x</a> <a id="1417" href="V3.UntypedInterpreter.html#1417" class="Bound">y</a> <a id="1419" class="Symbol">=</a> <a id="1421" href="V3.UntypedInterpreter.html#1417" class="Bound">y</a>

<a id="1424" class="Comment">-- Greater-than on integers.</a>

<a id="iGt"></a><a id="1454" href="V3.UntypedInterpreter.html#1454" class="Function">iGt</a> <a id="1458" class="Symbol">:</a> <a id="1460" class="Symbol">(</a><a id="1461" href="V3.UntypedInterpreter.html#1461" class="Bound">i</a> <a id="1463" href="V3.UntypedInterpreter.html#1463" class="Bound">j</a> <a id="1465" class="Symbol">:</a> <a id="1467" href="Agda.Builtin.Int.html#219" class="Datatype">ℤ</a><a id="1468" class="Symbol">)</a> <a id="1470" class="Symbol">→</a> <a id="1472" href="V3.AST.html#474" class="Datatype">Boolean</a>
<a id="1480" href="V3.UntypedInterpreter.html#1454" class="Function">iGt</a> <a id="1484" href="V3.UntypedInterpreter.html#1484" class="Bound">i</a> <a id="1486" href="V3.UntypedInterpreter.html#1486" class="Bound">j</a> <a id="1488" class="Symbol">=</a> <a id="1490" href="Function.html#3662" class="Function Operator">case</a> <a id="1495" href="V3.UntypedInterpreter.html#1484" class="Bound">i</a> <a id="1497" href="Library.html#2213" class="Function Operator">Integer.&lt;=</a> <a id="1508" href="V3.UntypedInterpreter.html#1486" class="Bound">j</a> <a id="1510" href="Function.html#3662" class="Function Operator">of</a> <a id="1513" class="Symbol">λ</a> <a id="1515" class="Keyword">where</a>
  <a id="1523" href="Agda.Builtin.Bool.html#154" class="InductiveConstructor">false</a> <a id="1529" class="Symbol">→</a> <a id="1531" href="V3.AST.html#496" class="InductiveConstructor">true</a>
  <a id="1538" href="Agda.Builtin.Bool.html#160" class="InductiveConstructor">true</a>  <a id="1544" class="Symbol">→</a> <a id="1546" href="V3.AST.html#501" class="InductiveConstructor">false</a>

<a id="1553" class="Comment">-- Evaluation of expressions.  The environment is fixed.</a>

<a id="1611" class="Keyword">module</a> <a id="EvalExp"></a><a id="1618" href="V3.UntypedInterpreter.html#1618" class="Module">EvalExp</a> <a id="1626" class="Symbol">(</a><a id="1627" href="V3.UntypedInterpreter.html#1627" class="Bound">ρ</a> <a id="1629" class="Symbol">:</a> <a id="1631" href="V3.UntypedInterpreter.html#525" class="Function">Env</a><a id="1634" class="Symbol">)</a> <a id="1636" class="Keyword">where</a>

  <a id="1645" class="Comment">-- Evaluation may fail due to scope or type errors, thus eval is partial.</a>
  <a id="1721" class="Comment">-- E.g. eval (eNot (eInt zero)) ≡ nothing.</a>

  <a id="EvalExp.eval"></a><a id="1767" href="V3.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="1772" class="Symbol">:</a> <a id="1774" href="V3.AST.html#584" class="Datatype">Exp</a> <a id="1778" class="Symbol">→</a> <a id="1780" href="Data.Maybe.Base.html#795" class="Datatype">Maybe</a> <a id="1786" href="V3.UntypedInterpreter.html#300" class="Datatype">Val</a>
  <a id="1792" href="V3.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="1797" class="Symbol">(</a><a id="1798" href="V3.AST.html#602" class="InductiveConstructor">eId</a> <a id="1802" href="V3.UntypedInterpreter.html#1802" class="Bound">x</a><a id="1803" class="Symbol">)</a>   <a id="1807" class="Symbol">=</a> <a id="1809" href="V3.UntypedInterpreter.html#622" class="Function">lookupId</a> <a id="1818" href="V3.UntypedInterpreter.html#1627" class="Bound">ρ</a> <a id="1820" href="V3.UntypedInterpreter.html#1802" class="Bound">x</a>
  <a id="1824" href="V3.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="1829" class="Symbol">(</a><a id="1830" href="V3.AST.html#635" class="InductiveConstructor">eInt</a> <a id="1835" href="V3.UntypedInterpreter.html#1835" class="Bound">i</a><a id="1836" class="Symbol">)</a>  <a id="1839" class="Symbol">=</a> <a id="1841" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="1846" class="Symbol">(</a><a id="1847" href="V3.UntypedInterpreter.html#318" class="InductiveConstructor">intV</a> <a id="1852" href="V3.UntypedInterpreter.html#1835" class="Bound">i</a><a id="1853" class="Symbol">)</a>
  <a id="1857" href="V3.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="1862" class="Symbol">(</a><a id="1863" href="V3.AST.html#668" class="InductiveConstructor">eBool</a> <a id="1869" href="V3.UntypedInterpreter.html#1869" class="Bound">b</a><a id="1870" class="Symbol">)</a> <a id="1872" class="Symbol">=</a> <a id="1874" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="1879" class="Symbol">(</a><a id="1880" href="V3.UntypedInterpreter.html#342" class="InductiveConstructor">boolV</a> <a id="1886" href="V3.UntypedInterpreter.html#1869" class="Bound">b</a><a id="1887" class="Symbol">)</a>
  <a id="1891" href="V3.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="1896" class="Symbol">(</a><a id="1897" href="V3.AST.html#701" class="InductiveConstructor">ePlus</a> <a id="1903" href="V3.UntypedInterpreter.html#1903" class="Bound">e₁</a> <a id="1906" href="V3.UntypedInterpreter.html#1906" class="Bound">e₂</a><a id="1908" class="Symbol">)</a> <a id="1910" class="Symbol">=</a> <a id="1912" href="Function.html#3662" class="Function Operator">case</a> <a id="1917" class="Symbol">(</a><a id="1918" href="V3.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="1923" href="V3.UntypedInterpreter.html#1903" class="Bound">e₁</a> <a id="1926" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1928" href="V3.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="1933" href="V3.UntypedInterpreter.html#1906" class="Bound">e₂</a><a id="1935" class="Symbol">)</a> <a id="1937" href="Function.html#3662" class="Function Operator">of</a> <a id="1940" class="Symbol">λ</a> <a id="1942" class="Keyword">where</a>
    <a id="1952" class="Symbol">(</a><a id="1953" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="1958" class="Symbol">(</a><a id="1959" href="V3.UntypedInterpreter.html#318" class="InductiveConstructor">intV</a> <a id="1964" href="V3.UntypedInterpreter.html#1964" class="Bound">i</a><a id="1965" class="Symbol">)</a> <a id="1967" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1969" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="1974" class="Symbol">(</a><a id="1975" href="V3.UntypedInterpreter.html#318" class="InductiveConstructor">intV</a> <a id="1980" href="V3.UntypedInterpreter.html#1980" class="Bound">j</a><a id="1981" class="Symbol">))</a> <a id="1984" class="Symbol">→</a> <a id="1986" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="1991" class="Symbol">(</a><a id="1992" href="V3.UntypedInterpreter.html#318" class="InductiveConstructor">intV</a> <a id="1997" class="Symbol">(</a><a id="1998" href="V3.UntypedInterpreter.html#1964" class="Bound">i</a> <a id="2000" href="Data.Integer.Base.html#2950" class="Function Operator">+</a> <a id="2002" href="V3.UntypedInterpreter.html#1980" class="Bound">j</a><a id="2003" class="Symbol">))</a>
    <a id="2010" class="CatchallClause Symbol">_</a> <a id="2012" class="Symbol">→</a> <a id="2014" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>
  <a id="2024" href="V3.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="2029" class="Symbol">(</a><a id="2030" href="V3.AST.html#734" class="InductiveConstructor">eGt</a> <a id="2034" href="V3.UntypedInterpreter.html#2034" class="Bound">e₁</a> <a id="2037" href="V3.UntypedInterpreter.html#2037" class="Bound">e₂</a><a id="2039" class="Symbol">)</a> <a id="2041" class="Symbol">=</a> <a id="2043" href="Function.html#3662" class="Function Operator">case</a> <a id="2048" class="Symbol">(</a><a id="2049" href="V3.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="2054" href="V3.UntypedInterpreter.html#2034" class="Bound">e₁</a> <a id="2057" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2059" href="V3.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="2064" href="V3.UntypedInterpreter.html#2037" class="Bound">e₂</a><a id="2066" class="Symbol">)</a> <a id="2068" href="Function.html#3662" class="Function Operator">of</a> <a id="2071" class="Symbol">λ</a> <a id="2073" class="Keyword">where</a>
    <a id="2083" class="Symbol">(</a><a id="2084" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2089" class="Symbol">(</a><a id="2090" href="V3.UntypedInterpreter.html#318" class="InductiveConstructor">intV</a> <a id="2095" href="V3.UntypedInterpreter.html#2095" class="Bound">i</a><a id="2096" class="Symbol">)</a> <a id="2098" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2100" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2105" class="Symbol">(</a><a id="2106" href="V3.UntypedInterpreter.html#318" class="InductiveConstructor">intV</a> <a id="2111" href="V3.UntypedInterpreter.html#2111" class="Bound">j</a><a id="2112" class="Symbol">))</a> <a id="2115" class="Symbol">→</a> <a id="2117" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2122" class="Symbol">(</a><a id="2123" href="V3.UntypedInterpreter.html#342" class="InductiveConstructor">boolV</a> <a id="2129" class="Symbol">(</a><a id="2130" href="V3.UntypedInterpreter.html#1454" class="Function">iGt</a> <a id="2134" href="V3.UntypedInterpreter.html#2095" class="Bound">i</a> <a id="2136" href="V3.UntypedInterpreter.html#2111" class="Bound">j</a><a id="2137" class="Symbol">))</a>
    <a id="2144" class="CatchallClause Symbol">_</a> <a id="2146" class="Symbol">→</a> <a id="2148" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>
  <a id="2158" href="V3.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="2163" class="Symbol">(</a><a id="2164" href="V3.AST.html#767" class="InductiveConstructor">eAnd</a> <a id="2169" href="V3.UntypedInterpreter.html#2169" class="Bound">e₁</a> <a id="2172" href="V3.UntypedInterpreter.html#2172" class="Bound">e₂</a><a id="2174" class="Symbol">)</a> <a id="2176" class="Symbol">=</a> <a id="2178" href="Function.html#3662" class="Function Operator">case</a> <a id="2183" class="Symbol">(</a><a id="2184" href="V3.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="2189" href="V3.UntypedInterpreter.html#2169" class="Bound">e₁</a> <a id="2192" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2194" href="V3.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="2199" href="V3.UntypedInterpreter.html#2172" class="Bound">e₂</a><a id="2201" class="Symbol">)</a> <a id="2203" href="Function.html#3662" class="Function Operator">of</a> <a id="2206" class="Symbol">λ</a> <a id="2208" class="Keyword">where</a>
    <a id="2218" class="Symbol">(</a><a id="2219" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2224" class="Symbol">(</a><a id="2225" href="V3.UntypedInterpreter.html#342" class="InductiveConstructor">boolV</a> <a id="2231" href="V3.UntypedInterpreter.html#2231" class="Bound">b₁</a><a id="2233" class="Symbol">)</a> <a id="2235" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2237" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2242" class="Symbol">(</a><a id="2243" href="V3.UntypedInterpreter.html#342" class="InductiveConstructor">boolV</a> <a id="2249" href="V3.UntypedInterpreter.html#2249" class="Bound">b₂</a><a id="2251" class="Symbol">))</a> <a id="2254" class="Symbol">→</a> <a id="2256" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2261" class="Symbol">(</a><a id="2262" href="V3.UntypedInterpreter.html#342" class="InductiveConstructor">boolV</a> <a id="2268" class="Symbol">(</a><a id="2269" href="V3.UntypedInterpreter.html#1251" class="Function">bAnd</a> <a id="2274" href="V3.UntypedInterpreter.html#2231" class="Bound">b₁</a> <a id="2277" href="V3.UntypedInterpreter.html#2249" class="Bound">b₂</a><a id="2279" class="Symbol">))</a>
    <a id="2286" class="CatchallClause Symbol">_</a> <a id="2288" class="Symbol">→</a> <a id="2290" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>
  <a id="2300" href="V3.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="2305" class="Symbol">(</a><a id="2306" href="V3.AST.html#800" class="InductiveConstructor">eCond</a> <a id="2312" href="V3.UntypedInterpreter.html#2312" class="Bound">e₁</a> <a id="2315" href="V3.UntypedInterpreter.html#2315" class="Bound">e₂</a> <a id="2318" href="V3.UntypedInterpreter.html#2318" class="Bound">e₃</a><a id="2320" class="Symbol">)</a> <a id="2322" class="Symbol">=</a> <a id="2324" href="Function.html#3662" class="Function Operator">case</a> <a id="2329" class="Symbol">(</a><a id="2330" href="V3.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="2335" href="V3.UntypedInterpreter.html#2312" class="Bound">e₁</a><a id="2337" class="Symbol">)</a> <a id="2339" href="Function.html#3662" class="Function Operator">of</a> <a id="2342" class="Symbol">λ</a> <a id="2344" class="Keyword">where</a>
    <a id="2354" class="Symbol">(</a><a id="2355" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2360" class="Symbol">(</a><a id="2361" href="V3.UntypedInterpreter.html#342" class="InductiveConstructor">boolV</a> <a id="2367" href="V3.UntypedInterpreter.html#2367" class="Bound">b</a><a id="2368" class="Symbol">))</a> <a id="2371" class="Symbol">→</a> <a id="2373" href="V3.UntypedInterpreter.html#1349" class="Function">bIf</a> <a id="2377" href="V3.UntypedInterpreter.html#2367" class="Bound">b</a> <a id="2379" class="Symbol">(</a><a id="2380" href="V3.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="2385" href="V3.UntypedInterpreter.html#2315" class="Bound">e₂</a><a id="2387" class="Symbol">)</a> <a id="2389" class="Symbol">(</a><a id="2390" href="V3.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="2395" href="V3.UntypedInterpreter.html#2318" class="Bound">e₃</a><a id="2397" class="Symbol">)</a>
    <a id="2403" class="CatchallClause Symbol">_</a> <a id="2405" class="Symbol">→</a> <a id="2407" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>

<a id="2416" class="Keyword">open</a> <a id="2421" href="V3.UntypedInterpreter.html#1618" class="Module">EvalExp</a>

<a id="2430" class="Comment">-- The execution of a declaration adds a new binding</a>
<a id="2483" class="Comment">-- to the environment.</a>

<a id="execDecl"></a><a id="2507" href="V3.UntypedInterpreter.html#2507" class="Function">execDecl</a> <a id="2516" class="Symbol">:</a> <a id="2518" href="V3.AST.html#944" class="Record">Decl</a> <a id="2523" class="Symbol">→</a> <a id="2525" href="V3.UntypedInterpreter.html#525" class="Function">Env</a> <a id="2529" class="Symbol">→</a> <a id="2531" href="Data.Maybe.Base.html#795" class="Datatype">Maybe</a> <a id="2537" href="V3.UntypedInterpreter.html#525" class="Function">Env</a>
<a id="2541" href="V3.UntypedInterpreter.html#2507" class="Function">execDecl</a> <a id="2550" class="Symbol">(</a><a id="2551" href="V3.AST.html#975" class="InductiveConstructor">dInit</a> <a id="2557" href="V3.UntypedInterpreter.html#2557" class="Bound">t</a> <a id="2559" href="V3.UntypedInterpreter.html#2559" class="Bound">x</a> <a id="2561" href="V3.UntypedInterpreter.html#2561" class="Bound">e</a><a id="2562" class="Symbol">)</a> <a id="2564" href="V3.UntypedInterpreter.html#2564" class="Bound">ρ</a> <a id="2566" class="Symbol">=</a> <a id="2568" href="Function.html#3662" class="Function Operator">case</a> <a id="2573" href="V3.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="2578" href="V3.UntypedInterpreter.html#2564" class="Bound">ρ</a> <a id="2580" href="V3.UntypedInterpreter.html#2561" class="Bound">e</a> <a id="2582" href="Function.html#3662" class="Function Operator">of</a> <a id="2585" class="Symbol">λ</a> <a id="2587" class="Keyword">where</a>
  <a id="2595" class="Symbol">(</a><a id="2596" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2601" href="V3.UntypedInterpreter.html#2601" class="Bound">v</a><a id="2602" class="Symbol">)</a> <a id="2604" class="Symbol">→</a> <a id="2606" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2611" class="Symbol">((</a><a id="2613" href="V3.UntypedInterpreter.html#2559" class="Bound">x</a> <a id="2615" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2617" href="V3.UntypedInterpreter.html#2601" class="Bound">v</a><a id="2618" class="Symbol">)</a> <a id="2620" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="2622" href="V3.UntypedInterpreter.html#2564" class="Bound">ρ</a><a id="2623" class="Symbol">)</a>
  <a id="2627" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>  <a id="2636" class="Symbol">→</a> <a id="2638" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>

<a id="2647" class="Comment">-- Execution of declarations returns the extended environment.</a>

<a id="execDecls"></a><a id="2711" href="V3.UntypedInterpreter.html#2711" class="Function">execDecls</a> <a id="2721" class="Symbol">:</a> <a id="2723" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="2728" href="V3.AST.html#944" class="Record">Decl</a> <a id="2733" class="Symbol">→</a> <a id="2735" href="V3.UntypedInterpreter.html#525" class="Function">Env</a> <a id="2739" class="Symbol">→</a> <a id="2741" href="Data.Maybe.Base.html#795" class="Datatype">Maybe</a> <a id="2747" href="V3.UntypedInterpreter.html#525" class="Function">Env</a>
<a id="2751" href="V3.UntypedInterpreter.html#2711" class="Function">execDecls</a> <a id="2761" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="2764" href="V3.UntypedInterpreter.html#2764" class="Bound">ρ</a> <a id="2766" class="Symbol">=</a> <a id="2768" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2773" href="V3.UntypedInterpreter.html#2764" class="Bound">ρ</a>
<a id="2775" href="V3.UntypedInterpreter.html#2711" class="Function">execDecls</a> <a id="2785" class="Symbol">(</a><a id="2786" href="V3.UntypedInterpreter.html#2786" class="Bound">d</a> <a id="2788" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="2790" href="V3.UntypedInterpreter.html#2790" class="Bound">ds</a><a id="2792" class="Symbol">)</a> <a id="2794" href="V3.UntypedInterpreter.html#2794" class="Bound">ρ</a> <a id="2796" class="Symbol">=</a> <a id="2798" href="Function.html#3662" class="Function Operator">case</a> <a id="2803" href="V3.UntypedInterpreter.html#2507" class="Function">execDecl</a> <a id="2812" href="V3.UntypedInterpreter.html#2786" class="Bound">d</a> <a id="2814" href="V3.UntypedInterpreter.html#2794" class="Bound">ρ</a> <a id="2816" href="Function.html#3662" class="Function Operator">of</a> <a id="2819" class="Symbol">λ</a> <a id="2821" class="Keyword">where</a>
  <a id="2829" class="Symbol">(</a><a id="2830" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2835" href="V3.UntypedInterpreter.html#2835" class="Bound">ρ&#39;</a><a id="2837" class="Symbol">)</a> <a id="2839" class="Symbol">→</a> <a id="2841" href="V3.UntypedInterpreter.html#2711" class="Function">execDecls</a> <a id="2851" href="V3.UntypedInterpreter.html#2790" class="Bound">ds</a> <a id="2854" href="V3.UntypedInterpreter.html#2835" class="Bound">ρ&#39;</a>
  <a id="2859" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>   <a id="2869" class="Symbol">→</a> <a id="2871" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>

<a id="2880" class="Comment">-- Execution of statements can change values in the environment</a>
<a id="2944" class="Comment">-- and can diverge.</a>

<a id="2965" class="Keyword">module</a> <a id="ExecStm"></a><a id="2972" href="V3.UntypedInterpreter.html#2972" class="Module">ExecStm</a> <a id="2980" class="Keyword">where</a>

  <a id="2989" class="Comment">-- Execution is parameterized by a number (fuel : ℕ)</a>
  <a id="3044" class="Comment">-- that limits the number of executions of while loops.</a>
  <a id="3102" class="Comment">-- This is necessary to please Agda&#39;s termination checker.</a>

  <a id="3164" class="Keyword">mutual</a>

    <a id="ExecStm.execStm"></a><a id="3176" href="V3.UntypedInterpreter.html#3176" class="Function">execStm</a> <a id="3184" class="Symbol">:</a> <a id="3186" class="Symbol">(</a><a id="3187" href="V3.UntypedInterpreter.html#3187" class="Bound">fuel</a> <a id="3192" class="Symbol">:</a> <a id="3194" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a><a id="3195" class="Symbol">)</a> <a id="3197" class="Symbol">→</a> <a id="3199" href="V3.AST.html#1125" class="Datatype">Stm</a> <a id="3203" class="Symbol">→</a> <a id="3205" href="V3.UntypedInterpreter.html#525" class="Function">Env</a> <a id="3209" class="Symbol">→</a> <a id="3211" href="Data.Maybe.Base.html#795" class="Datatype">Maybe</a> <a id="3217" href="V3.UntypedInterpreter.html#525" class="Function">Env</a>

    <a id="3226" href="V3.UntypedInterpreter.html#3176" class="Function">execStm</a> <a id="3234" class="Symbol">_</a> <a id="3236" class="Symbol">(</a><a id="3237" href="V3.AST.html#1143" class="InductiveConstructor">sAss</a> <a id="3242" href="V3.UntypedInterpreter.html#3242" class="Bound">x</a> <a id="3244" href="V3.UntypedInterpreter.html#3244" class="Bound">e</a><a id="3245" class="Symbol">)</a> <a id="3247" href="V3.UntypedInterpreter.html#3247" class="Bound">ρ</a> <a id="3249" class="Symbol">=</a> <a id="3251" href="Function.html#3662" class="Function Operator">case</a> <a id="3256" href="V3.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="3261" href="V3.UntypedInterpreter.html#3247" class="Bound">ρ</a> <a id="3263" href="V3.UntypedInterpreter.html#3244" class="Bound">e</a> <a id="3265" href="Function.html#3662" class="Function Operator">of</a> <a id="3268" class="Symbol">λ</a> <a id="3270" class="Keyword">where</a>
      <a id="3282" class="Symbol">(</a><a id="3283" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="3288" href="V3.UntypedInterpreter.html#3288" class="Bound">v</a><a id="3289" class="Symbol">)</a> <a id="3291" class="Symbol">→</a> <a id="3293" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="3298" class="Symbol">(</a><a id="3299" href="V3.UntypedInterpreter.html#819" class="Function">updateEnv</a> <a id="3309" href="V3.UntypedInterpreter.html#3242" class="Bound">x</a> <a id="3311" href="V3.UntypedInterpreter.html#3288" class="Bound">v</a> <a id="3313" href="V3.UntypedInterpreter.html#3247" class="Bound">ρ</a><a id="3314" class="Symbol">)</a>
      <a id="3322" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>  <a id="3331" class="Symbol">→</a> <a id="3333" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>

    <a id="3346" href="V3.UntypedInterpreter.html#3176" class="Function">execStm</a> <a id="3354" class="Number">0</a>          <a id="3365" class="Symbol">(</a><a id="3366" href="V3.AST.html#1191" class="InductiveConstructor">sWhile</a> <a id="3373" href="V3.UntypedInterpreter.html#3373" class="Bound">e</a> <a id="3375" href="V3.UntypedInterpreter.html#3375" class="Bound">ss</a><a id="3377" class="Symbol">)</a> <a id="3379" href="V3.UntypedInterpreter.html#3379" class="Bound">ρ</a> <a id="3381" class="Symbol">=</a> <a id="3383" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>
    <a id="3395" href="V3.UntypedInterpreter.html#3176" class="Function">execStm</a> <a id="3403" class="Symbol">(</a><a id="3404" href="Agda.Builtin.Nat.html#196" class="InductiveConstructor">suc</a> <a id="3408" href="V3.UntypedInterpreter.html#3408" class="Bound">fuel</a><a id="3412" class="Symbol">)</a> <a id="3414" class="Symbol">(</a><a id="3415" href="V3.AST.html#1191" class="InductiveConstructor">sWhile</a> <a id="3422" href="V3.UntypedInterpreter.html#3422" class="Bound">e</a> <a id="3424" href="V3.UntypedInterpreter.html#3424" class="Bound">ss</a><a id="3426" class="Symbol">)</a> <a id="3428" href="V3.UntypedInterpreter.html#3428" class="Bound">ρ</a> <a id="3430" class="Symbol">=</a> <a id="3432" href="Function.html#3662" class="Function Operator">case</a> <a id="3437" href="V3.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="3442" href="V3.UntypedInterpreter.html#3428" class="Bound">ρ</a> <a id="3444" href="V3.UntypedInterpreter.html#3422" class="Bound">e</a> <a id="3446" href="Function.html#3662" class="Function Operator">of</a> <a id="3449" class="Symbol">λ</a> <a id="3451" class="Keyword">where</a>
      <a id="3463" class="Symbol">(</a><a id="3464" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="3469" class="Symbol">(</a><a id="3470" href="V3.UntypedInterpreter.html#342" class="InductiveConstructor">boolV</a> <a id="3476" href="V3.AST.html#496" class="InductiveConstructor">true</a><a id="3480" class="Symbol">))</a> <a id="3483" class="Symbol">→</a> <a id="3485" href="Function.html#3662" class="Function Operator">case</a> <a id="3490" href="V3.UntypedInterpreter.html#3762" class="Function">execStms</a> <a id="3499" href="V3.UntypedInterpreter.html#3408" class="Bound">fuel</a> <a id="3504" href="V3.UntypedInterpreter.html#3424" class="Bound">ss</a> <a id="3507" href="V3.UntypedInterpreter.html#3428" class="Bound">ρ</a> <a id="3509" href="Function.html#3662" class="Function Operator">of</a> <a id="3512" class="Symbol">λ</a> <a id="3514" class="Keyword">where</a>
        <a id="3528" class="Symbol">(</a><a id="3529" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="3534" href="V3.UntypedInterpreter.html#3534" class="Bound">ρ&#39;</a><a id="3536" class="Symbol">)</a> <a id="3538" class="Symbol">→</a> <a id="3540" href="V3.UntypedInterpreter.html#3176" class="Function">execStm</a> <a id="3548" href="V3.UntypedInterpreter.html#3408" class="Bound">fuel</a> <a id="3553" class="Symbol">(</a><a id="3554" href="V3.AST.html#1191" class="InductiveConstructor">sWhile</a> <a id="3561" href="V3.UntypedInterpreter.html#3422" class="Bound">e</a> <a id="3563" href="V3.UntypedInterpreter.html#3424" class="Bound">ss</a><a id="3565" class="Symbol">)</a> <a id="3567" href="V3.UntypedInterpreter.html#3534" class="Bound">ρ&#39;</a>
        <a id="3578" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>   <a id="3588" class="Symbol">→</a> <a id="3590" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>
      <a id="3604" class="Symbol">(</a><a id="3605" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="3610" class="Symbol">(</a><a id="3611" href="V3.UntypedInterpreter.html#342" class="InductiveConstructor">boolV</a> <a id="3617" href="V3.AST.html#501" class="InductiveConstructor">false</a><a id="3622" class="Symbol">))</a> <a id="3625" class="Symbol">→</a> <a id="3627" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="3632" href="V3.UntypedInterpreter.html#3428" class="Bound">ρ</a>
      <a id="3640" class="CatchallClause Symbol">_</a>                    <a id="3661" class="Symbol">→</a> <a id="3663" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>

    <a id="3676" class="Comment">-- Execution of a statement sequence, passes the fuel</a>
    <a id="3734" class="Comment">-- to every statement.</a>

    <a id="ExecStm.execStms"></a><a id="3762" href="V3.UntypedInterpreter.html#3762" class="Function">execStms</a> <a id="3771" class="Symbol">:</a> <a id="3773" class="Symbol">(</a><a id="3774" href="V3.UntypedInterpreter.html#3774" class="Bound">fuel</a> <a id="3779" class="Symbol">:</a> <a id="3781" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a><a id="3782" class="Symbol">)</a> <a id="3784" class="Symbol">→</a> <a id="3786" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="3791" href="V3.AST.html#1125" class="Datatype">Stm</a> <a id="3795" class="Symbol">→</a> <a id="3797" href="V3.UntypedInterpreter.html#525" class="Function">Env</a> <a id="3801" class="Symbol">→</a> <a id="3803" href="Data.Maybe.Base.html#795" class="Datatype">Maybe</a> <a id="3809" href="V3.UntypedInterpreter.html#525" class="Function">Env</a>
    <a id="3817" href="V3.UntypedInterpreter.html#3762" class="Function">execStms</a> <a id="3826" class="Symbol">_</a>    <a id="3831" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>       <a id="3840" href="V3.UntypedInterpreter.html#3840" class="Bound">ρ</a> <a id="3842" class="Symbol">=</a> <a id="3844" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="3849" href="V3.UntypedInterpreter.html#3840" class="Bound">ρ</a>
    <a id="3855" href="V3.UntypedInterpreter.html#3762" class="Function">execStms</a> <a id="3864" href="V3.UntypedInterpreter.html#3864" class="Bound">fuel</a> <a id="3869" class="Symbol">(</a><a id="3870" href="V3.UntypedInterpreter.html#3870" class="Bound">s</a> <a id="3872" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="3874" href="V3.UntypedInterpreter.html#3874" class="Bound">ss</a><a id="3876" class="Symbol">)</a> <a id="3878" href="V3.UntypedInterpreter.html#3878" class="Bound">ρ</a> <a id="3880" class="Symbol">=</a> <a id="3882" href="Function.html#3662" class="Function Operator">case</a> <a id="3887" href="V3.UntypedInterpreter.html#3176" class="Function">execStm</a> <a id="3895" href="V3.UntypedInterpreter.html#3864" class="Bound">fuel</a> <a id="3900" href="V3.UntypedInterpreter.html#3870" class="Bound">s</a> <a id="3902" href="V3.UntypedInterpreter.html#3878" class="Bound">ρ</a> <a id="3904" href="Function.html#3662" class="Function Operator">of</a> <a id="3907" class="Symbol">λ</a> <a id="3909" class="Keyword">where</a>
      <a id="3921" class="Symbol">(</a><a id="3922" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="3927" href="V3.UntypedInterpreter.html#3927" class="Bound">ρ&#39;</a><a id="3929" class="Symbol">)</a> <a id="3931" class="Symbol">→</a> <a id="3933" href="V3.UntypedInterpreter.html#3762" class="Function">execStms</a> <a id="3942" href="V3.UntypedInterpreter.html#3864" class="Bound">fuel</a> <a id="3947" href="V3.UntypedInterpreter.html#3874" class="Bound">ss</a> <a id="3950" href="V3.UntypedInterpreter.html#3927" class="Bound">ρ&#39;</a>
      <a id="3959" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>   <a id="3969" class="Symbol">→</a> <a id="3971" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>

  <a id="3982" class="Comment">-- We evaluate a program by first executing the declarations,</a>
  <a id="4046" class="Comment">-- then the statements, and finally evaluating the main expression.</a>

  <a id="ExecStm.evalPrg"></a><a id="4117" href="V3.UntypedInterpreter.html#4117" class="Function">evalPrg</a> <a id="4125" class="Symbol">:</a> <a id="4127" class="Symbol">(</a><a id="4128" href="V3.UntypedInterpreter.html#4128" class="Bound">fuel</a> <a id="4133" class="Symbol">:</a> <a id="4135" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a><a id="4136" class="Symbol">)</a> <a id="4138" class="Symbol">→</a> <a id="4140" href="V3.AST.html#1305" class="Record">Program</a> <a id="4148" class="Symbol">→</a> <a id="4150" href="Data.Maybe.Base.html#795" class="Datatype">Maybe</a> <a id="4156" href="Agda.Builtin.Int.html#219" class="Datatype">ℤ</a>
  <a id="4160" href="V3.UntypedInterpreter.html#4117" class="Function">evalPrg</a> <a id="4168" href="V3.UntypedInterpreter.html#4168" class="Bound">fuel</a> <a id="4173" class="Symbol">(</a><a id="4174" href="V3.AST.html#1339" class="InductiveConstructor">program</a> <a id="4182" href="V3.UntypedInterpreter.html#4182" class="Bound">ds</a> <a id="4185" href="V3.UntypedInterpreter.html#4185" class="Bound">ss</a> <a id="4188" href="V3.UntypedInterpreter.html#4188" class="Bound">e</a><a id="4189" class="Symbol">)</a> <a id="4191" class="Symbol">=</a> <a id="4193" href="Function.html#3662" class="Function Operator">case</a> <a id="4198" href="V3.UntypedInterpreter.html#2711" class="Function">execDecls</a> <a id="4208" href="V3.UntypedInterpreter.html#4182" class="Bound">ds</a> <a id="4211" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="4214" href="Function.html#3662" class="Function Operator">of</a> <a id="4217" class="Symbol">λ</a> <a id="4219" class="Keyword">where</a>
    <a id="4229" class="Symbol">(</a><a id="4230" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="4235" href="V3.UntypedInterpreter.html#4235" class="Bound">ρ₀</a><a id="4237" class="Symbol">)</a> <a id="4239" class="Symbol">→</a> <a id="4241" href="Function.html#3662" class="Function Operator">case</a> <a id="4246" href="V3.UntypedInterpreter.html#3762" class="Function">execStms</a> <a id="4255" href="V3.UntypedInterpreter.html#4168" class="Bound">fuel</a> <a id="4260" href="V3.UntypedInterpreter.html#4185" class="Bound">ss</a> <a id="4263" href="V3.UntypedInterpreter.html#4235" class="Bound">ρ₀</a> <a id="4266" href="Function.html#3662" class="Function Operator">of</a> <a id="4269" class="Symbol">λ</a> <a id="4271" class="Keyword">where</a>
      <a id="4283" class="Symbol">(</a><a id="4284" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="4289" href="V3.UntypedInterpreter.html#4289" class="Bound">ρ</a><a id="4290" class="Symbol">)</a> <a id="4292" class="Symbol">→</a> <a id="4294" href="Function.html#3662" class="Function Operator">case</a> <a id="4299" href="V3.UntypedInterpreter.html#1767" class="Function">eval</a> <a id="4304" href="V3.UntypedInterpreter.html#4289" class="Bound">ρ</a> <a id="4306" href="V3.UntypedInterpreter.html#4188" class="Bound">e</a> <a id="4308" href="Function.html#3662" class="Function Operator">of</a> <a id="4311" class="Symbol">λ</a> <a id="4313" class="Keyword">where</a>
        <a id="4327" class="Symbol">(</a><a id="4328" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="4333" class="Symbol">(</a><a id="4334" href="V3.UntypedInterpreter.html#318" class="InductiveConstructor">intV</a> <a id="4339" href="V3.UntypedInterpreter.html#4339" class="Bound">v</a><a id="4340" class="Symbol">))</a> <a id="4343" class="Symbol">→</a> <a id="4345" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="4350" href="V3.UntypedInterpreter.html#4339" class="Bound">v</a>
        <a id="4360" class="CatchallClause Symbol">_</a>               <a id="4376" class="Symbol">→</a> <a id="4378" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>
      <a id="4392" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>  <a id="4401" class="Symbol">→</a> <a id="4403" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>
    <a id="4415" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>   <a id="4425" class="Symbol">→</a> <a id="4427" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>
</pre></body></html>